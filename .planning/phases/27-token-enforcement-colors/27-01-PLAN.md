---
phase: 27-token-enforcement-colors
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/tokens.css
  - tailwind.config.ts
  - src/components/homepage/Hero.tsx
  - src/components/homepage/CTABanner.tsx
  - src/components/homepage/FooterCTA.tsx
  - src/components/homepage/HomepageMenuSection.tsx
  - src/components/homepage/TestimonialsCarousel.tsx
  - src/components/homepage/HowItWorksSection.tsx
  - src/components/homepage/HomePageClient.tsx
  - src/components/checkout/AddressInput.tsx
  - src/components/checkout/TimeSlotPicker.tsx
  - src/components/checkout/PaymentSuccess.tsx
  - src/components/checkout/PaymentStepV8.tsx
  - src/components/checkout/AddressCardV8.tsx
  - src/components/checkout/CheckoutWizard.tsx
autonomous: true

must_haves:
  truths:
    - "Overlay, skeleton, and disabled tokens exist in tokens.css and tailwind.config.ts"
    - "Zero text-white/text-black violations in homepage components"
    - "Zero bg-white/bg-black violations in homepage components"
    - "Zero text-white/text-black violations in checkout components"
    - "Zero bg-white/bg-black violations in checkout components"
    - "Both light and dark themes render correctly on homepage and checkout"
  artifacts:
    - path: "src/styles/tokens.css"
      provides: "Overlay, skeleton, disabled token definitions"
      contains: "--color-overlay"
    - path: "tailwind.config.ts"
      provides: "Tailwind utility mappings for new tokens"
      contains: "overlay:"
  key_links:
    - from: "tailwind.config.ts"
      to: "src/styles/tokens.css"
      via: "CSS variable references"
      pattern: "var\\(--color-overlay"
---

<objective>
Add missing design tokens and migrate homepage + checkout pages to semantic color tokens.

Purpose: Establishes token foundation and fixes highest-traffic pages first
Output: Complete token system + violation-free homepage and checkout
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/27-token-enforcement-colors/27-CONTEXT.md
@.planning/phases/27-token-enforcement-colors/27-RESEARCH.md
@src/styles/tokens.css
@tailwind.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add missing token definitions</name>
  <files>src/styles/tokens.css, tailwind.config.ts</files>
  <action>
Add missing tokens to tokens.css in both :root and .dark sections:

```css
/* Add to :root section */
/* Overlay tokens for modals, drawers, backdrops */
--color-overlay: rgba(0, 0, 0, 0.5);
--color-overlay-heavy: rgba(0, 0, 0, 0.8);
--color-overlay-light: rgba(255, 255, 255, 0.5);

/* Skeleton/loading state */
--color-skeleton: #e5e7eb;
--color-skeleton-shimmer: rgba(255, 255, 255, 0.4);

/* Disabled states */
--color-disabled-bg: #f3f4f6;
--color-disabled-text: #9ca3af;

/* Selection/highlight */
--color-selection: rgba(164, 16, 52, 0.15);
```

```css
/* Add to .dark section */
--color-overlay: rgba(0, 0, 0, 0.7);
--color-overlay-heavy: rgba(0, 0, 0, 0.9);
--color-overlay-light: rgba(255, 255, 255, 0.3);
--color-skeleton: #374151;
--color-skeleton-shimmer: rgba(255, 255, 255, 0.1);
--color-disabled-bg: #1f2937;
--color-disabled-text: #6b7280;
--color-selection: rgba(255, 77, 109, 0.2);
```

Add to tailwind.config.ts colors section:

```typescript
overlay: {
  DEFAULT: "var(--color-overlay)",
  heavy: "var(--color-overlay-heavy)",
  light: "var(--color-overlay-light)",
},
skeleton: {
  DEFAULT: "var(--color-skeleton)",
  shimmer: "var(--color-skeleton-shimmer)",
},
disabled: {
  bg: "var(--color-disabled-bg)",
  text: "var(--color-disabled-text)",
},
selection: "var(--color-selection)",
```
  </action>
  <verify>Run `grep -r "color-overlay" src/styles/tokens.css` returns matches for both :root and .dark</verify>
  <done>Overlay, skeleton, disabled, and selection tokens defined in CSS and mapped in Tailwind config</done>
</task>

<task type="auto">
  <name>Task 2: Migrate homepage components to semantic tokens</name>
  <files>
    src/components/homepage/Hero.tsx
    src/components/homepage/CTABanner.tsx
    src/components/homepage/FooterCTA.tsx
    src/components/homepage/HomepageMenuSection.tsx
    src/components/homepage/TestimonialsCarousel.tsx
    src/components/homepage/HowItWorksSection.tsx
    src/components/homepage/HomePageClient.tsx
  </files>
  <action>
Replace hardcoded colors with semantic tokens in all homepage components:

Token mapping rules:
- `text-white` on hero/dark backgrounds -> `text-hero-text`
- `text-white/70` or opacity variants -> `text-hero-text-muted`
- `text-black` -> `text-text-primary` or `text-foreground`
- `bg-white` -> `bg-surface-primary` or `bg-background`
- `bg-black` for overlays -> `bg-overlay` or `bg-overlay-heavy`
- `bg-white/50` for light overlays -> `bg-overlay-light`

Specific patterns to find and replace:
1. Hero.tsx: Text on gradient backgrounds uses hero tokens
2. CTABanner.tsx: Button text and backgrounds
3. FooterCTA.tsx: Text and background colors
4. HomepageMenuSection.tsx: Card and text colors
5. TestimonialsCarousel.tsx: Testimonial card styling
6. HowItWorksSection.tsx: Step cards and text
7. HomePageClient.tsx: Any inline color values

Do NOT change colors inside gradient definitions (those are handled in Plan 04).
  </action>
  <verify>Run `grep -E "text-white|text-black|bg-white|bg-black" src/components/homepage/*.tsx` returns no matches</verify>
  <done>All homepage components use semantic tokens, zero hardcoded white/black values</done>
</task>

<task type="auto">
  <name>Task 3: Migrate checkout components to semantic tokens</name>
  <files>
    src/components/checkout/AddressInput.tsx
    src/components/checkout/TimeSlotPicker.tsx
    src/components/checkout/PaymentSuccess.tsx
    src/components/checkout/PaymentStepV8.tsx
    src/components/checkout/AddressCardV8.tsx
    src/components/checkout/CheckoutWizard.tsx
  </files>
  <action>
Replace hardcoded colors with semantic tokens in checkout components:

Token mapping rules:
- `text-white` on colored buttons -> `text-primary-foreground` or `text-text-inverse`
- `text-black` -> `text-text-primary` or `text-foreground`
- `bg-white` for cards/surfaces -> `bg-surface-primary` or `bg-background`
- `bg-black` for overlays -> `bg-overlay`
- Status indicators: Use `text-status-success`, `text-status-error`, etc.

Specific patterns:
1. AddressInput.tsx: Input styling and placeholder colors
2. TimeSlotPicker.tsx: Selected/unselected slot styling (highest violations here)
3. PaymentSuccess.tsx: Success state colors
4. PaymentStepV8.tsx: Payment method styling
5. AddressCardV8.tsx: Card backgrounds
6. CheckoutWizard.tsx: Step indicator colors
  </action>
  <verify>Run `grep -E "text-white|text-black|bg-white|bg-black" src/components/checkout/*.tsx` returns no matches</verify>
  <done>All checkout components use semantic tokens, zero hardcoded white/black values</done>
</task>

</tasks>

<verification>
1. Run `pnpm typecheck` - no type errors
2. Run `pnpm lint` - no ESLint color violations in modified files
3. Run `pnpm build` - builds successfully
4. Manual: Open homepage in browser, toggle between light/dark themes - both render correctly
5. Manual: Open checkout flow, toggle between light/dark themes - both render correctly
</verification>

<success_criteria>
- All new tokens (overlay, skeleton, disabled, selection) defined and mapped
- Zero `text-white`, `text-black`, `bg-white`, `bg-black` in homepage components
- Zero `text-white`, `text-black`, `bg-white`, `bg-black` in checkout components
- Both themes render correctly on homepage and checkout pages
- Build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/27-token-enforcement-colors/27-01-SUMMARY.md`
</output>
