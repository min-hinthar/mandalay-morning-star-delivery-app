---
phase: 05-menu-browsing
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui-v8/menu/MenuItemCardV8.tsx
  - src/components/ui-v8/menu/BlurImage.tsx
  - src/components/ui-v8/menu/FavoriteButton.tsx
  - src/components/ui-v8/menu/EmojiPlaceholder.tsx
autonomous: true

must_haves:
  truths:
    - "Menu item cards have hover lift and tap scale effects"
    - "Images lazy load with blur-up placeholder effect"
    - "Heart button animates with bounce on favorite toggle"
    - "Items without images show category-appropriate emoji placeholder"
  artifacts:
    - path: "src/components/ui-v8/menu/MenuItemCardV8.tsx"
      provides: "Animated menu item card with hover/tap effects"
      exports: ["MenuItemCardV8", "MenuItemCardV8Skeleton"]
    - path: "src/components/ui-v8/menu/BlurImage.tsx"
      provides: "Next.js Image with blur placeholder"
      exports: ["BlurImage"]
    - path: "src/components/ui-v8/menu/FavoriteButton.tsx"
      provides: "Animated heart toggle button"
      exports: ["FavoriteButton"]
    - path: "src/components/ui-v8/menu/EmojiPlaceholder.tsx"
      provides: "Emoji fallback for missing images"
      exports: ["EmojiPlaceholder"]
  key_links:
    - from: "MenuItemCardV8.tsx"
      to: "BlurImage.tsx"
      via: "import"
      pattern: "import.*BlurImage"
    - from: "MenuItemCardV8.tsx"
      to: "FavoriteButton.tsx"
      via: "import"
      pattern: "import.*FavoriteButton"
    - from: "FavoriteButton.tsx"
      to: "motion-tokens"
      via: "spring.ultraBouncy"
      pattern: "spring\\.ultraBouncy"
---

<objective>
Build V8 menu item cards with motion effects, blur-up image loading, animated favorites, and emoji placeholders.

Purpose: MENU-02, MENU-07, MENU-08, MENU-09 requirements
Output: MenuItemCardV8 and supporting components ready for grid/list layouts
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-menu-browsing/05-RESEARCH.md

@src/lib/motion-tokens.ts
@src/lib/utils/image-optimization.ts
@src/lib/hooks/useAnimationPreference.ts
@src/components/menu/menu-item-card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BlurImage and EmojiPlaceholder components</name>
  <files>src/components/ui-v8/menu/BlurImage.tsx, src/components/ui-v8/menu/EmojiPlaceholder.tsx</files>
  <action>
**BlurImage.tsx:**
Create a Next.js Image wrapper with blur-up placeholder:

```tsx
"use client";

import Image from "next/image";
import { useState } from "react";
import { getPlaceholderBlur, IMAGE_SIZES } from "@/lib/utils/image-optimization";
import { cn } from "@/lib/utils/cn";

interface BlurImageProps {
  src: string;
  alt: string;
  fill?: boolean;
  width?: number;
  height?: number;
  sizes?: string;
  priority?: boolean;
  className?: string;
}

export function BlurImage({
  src,
  alt,
  fill = true,
  sizes = IMAGE_SIZES.menuCard.sizes,
  priority = false,
  className,
  ...props
}: BlurImageProps) {
  const [isLoaded, setIsLoaded] = useState(false);

  return (
    <Image
      src={src}
      alt={alt}
      fill={fill}
      sizes={sizes}
      priority={priority}
      placeholder="blur"
      blurDataURL={getPlaceholderBlur("#f5f5f0")}
      onLoad={() => setIsLoaded(true)}
      className={cn(
        "object-cover transition-opacity duration-300",
        isLoaded ? "opacity-100" : "opacity-0",
        className
      )}
      {...props}
    />
  );
}
```

**EmojiPlaceholder.tsx:**
Create category-appropriate emoji placeholder:

```tsx
const CATEGORY_EMOJI_MAP: Record<string, string> = {
  salads: "ü•ó",
  soups: "üçú",
  curries: "üçõ",
  noodles: "üçù",
  rice: "üçö",
  appetizers: "ü•ü",
  desserts: "üçÆ",
  beverages: "üßã",
  drinks: "üßã",
  snacks: "ü•†",
  mains: "üçΩÔ∏è",
  sides: "ü•¨",
  specials: "‚≠ê",
  default: "üçΩÔ∏è",
};

interface EmojiPlaceholderProps {
  categorySlug?: string;
  className?: string;
}

export function EmojiPlaceholder({ categorySlug, className }: EmojiPlaceholderProps) {
  const emoji = CATEGORY_EMOJI_MAP[categorySlug ?? "default"] ?? CATEGORY_EMOJI_MAP.default;

  return (
    <div className={cn(
      "flex h-full w-full items-center justify-center",
      "bg-gradient-to-br from-surface-secondary to-surface-tertiary",
      className
    )}>
      <span className="text-5xl" role="img" aria-label="Food placeholder">
        {emoji}
      </span>
    </div>
  );
}
```
  </action>
  <verify>`pnpm typecheck` passes</verify>
  <done>BlurImage uses Next.js Image with blur placeholder, EmojiPlaceholder shows category-appropriate emoji</done>
</task>

<task type="auto">
  <name>Task 2: Create FavoriteButton with heart animation</name>
  <files>src/components/ui-v8/menu/FavoriteButton.tsx</files>
  <action>
Create FavoriteButton with bouncy heart animation:

```tsx
"use client";

import { motion, AnimatePresence } from "framer-motion";
import { Heart } from "lucide-react";
import { spring } from "@/lib/motion-tokens";
import { useAnimationPreference } from "@/lib/hooks/useAnimationPreference";
import { cn } from "@/lib/utils/cn";

interface FavoriteButtonProps {
  isFavorite: boolean;
  onToggle: () => void;
  className?: string;
  size?: "sm" | "md";
}

export function FavoriteButton({
  isFavorite,
  onToggle,
  className,
  size = "md",
}: FavoriteButtonProps) {
  const { shouldAnimate, getSpring } = useAnimationPreference();

  const handleClick = (e: React.MouseEvent) => {
    e.stopPropagation();
    e.preventDefault();

    // Haptic feedback on mobile
    if (typeof navigator !== "undefined" && navigator.vibrate) {
      navigator.vibrate(10);
    }

    onToggle();
  };

  const sizeClasses = {
    sm: "h-8 w-8",
    md: "h-10 w-10",
  };

  const iconSizes = {
    sm: "h-4 w-4",
    md: "h-5 w-5",
  };

  return (
    <motion.button
      type="button"
      onClick={handleClick}
      whileTap={shouldAnimate ? { scale: 0.85 } : undefined}
      className={cn(
        "flex items-center justify-center",
        "rounded-full bg-surface-primary/95 backdrop-blur-sm shadow-md",
        "transition-all duration-fast",
        "hover:scale-110 active:scale-95",
        "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2",
        sizeClasses[size],
        className
      )}
      aria-label={isFavorite ? "Remove from favorites" : "Add to favorites"}
      aria-pressed={isFavorite}
    >
      <AnimatePresence mode="wait">
        <motion.div
          key={isFavorite ? "filled" : "outline"}
          initial={shouldAnimate ? { scale: 0 } : undefined}
          animate={{ scale: 1 }}
          exit={shouldAnimate ? { scale: 0 } : undefined}
          transition={shouldAnimate ? getSpring(spring.ultraBouncy) : { duration: 0 }}
        >
          <Heart
            className={cn(
              "transition-colors duration-fast",
              iconSizes[size],
              isFavorite
                ? "fill-primary text-primary"
                : "text-text-muted"
            )}
          />
        </motion.div>
      </AnimatePresence>
    </motion.button>
  );
}
```
  </action>
  <verify>`pnpm typecheck` passes</verify>
  <done>FavoriteButton renders with bouncy heart animation on toggle</done>
</task>

<task type="auto">
  <name>Task 3: Create MenuItemCardV8 with motion effects</name>
  <files>src/components/ui-v8/menu/MenuItemCardV8.tsx</files>
  <action>
Create MenuItemCardV8 with hover/tap animations:

1. Props interface:
   ```tsx
   interface MenuItemCardV8Props {
     item: MenuItem;
     onSelect?: (item: MenuItem) => void;
     onFavoriteToggle?: (itemId: string, isFavorite: boolean) => void;
     isFavorite?: boolean;
     showFavorite?: boolean;
     categorySlug?: string; // For emoji placeholder
     className?: string;
   }
   ```

2. Motion configuration:
   - whileHover: `{ y: -6, scale: 1.02 }` (lift effect)
   - whileTap: `{ scale: 0.97 }` (press effect)
   - Use `spring.snappy` from motion-tokens
   - Respect `useAnimationPreference().shouldAnimate`

3. Card structure:
   ```tsx
   <motion.article
     data-menu-card // For GSAP stagger targeting
     onClick={() => onSelect?.(item)}
     whileHover={shouldAnimate ? { y: -6, scale: 1.02 } : undefined}
     whileTap={shouldAnimate ? { scale: 0.97 } : undefined}
     transition={shouldAnimate ? getSpring(spring.snappy) : { duration: 0 }}
     className={cn(
       "group relative overflow-hidden cursor-pointer",
       "rounded-card bg-surface-primary border border-border shadow-card",
       "transition-shadow duration-normal",
       "hover:shadow-card-hover hover:border-border-strong",
       "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",
       item.isSoldOut && "opacity-60 grayscale pointer-events-none"
     )}
   >
   ```

4. Image section:
   - Container: `relative aspect-video overflow-hidden rounded-t-card`
   - If item.imageUrl exists: use BlurImage with group-hover:scale-[1.03] effect
   - If no image: use EmojiPlaceholder with categorySlug
   - Popular badge (if item.tags includes "popular" or "featured")
   - FavoriteButton positioned absolute top-right

5. Content section:
   - Padding: `p-4`
   - Title: nameEn with `font-display font-bold text-text-primary`
   - Burmese name: nameMy with `font-burmese text-text-muted`
   - Price: `font-display font-bold text-primary`
   - Sold out overlay if item.isSoldOut

6. Create MenuItemCardV8Skeleton:
   - Same card structure with shimmer animations
   - Use `animate-shimmer` class pattern from existing skeletons
  </action>
  <verify>`pnpm typecheck && pnpm lint` passes</verify>
  <done>MenuItemCardV8 has hover lift, tap scale, blur image loading, favorite button, emoji placeholder</done>
</task>

</tasks>

<verification>
- `pnpm typecheck` passes
- `pnpm lint` passes
- All 4 components export correctly
- BlurImage uses Next.js Image with blur placeholder
- FavoriteButton has bouncy animation with spring.ultraBouncy
- MenuItemCardV8 has data-menu-card attribute for GSAP targeting
</verification>

<success_criteria>
- MenuItemCardV8 displays with hover/tap motion effects
- BlurImage shows blur-up loading transition
- FavoriteButton animates heart icon on toggle
- EmojiPlaceholder shows category-appropriate emoji
- All components respect animation preference
</success_criteria>

<output>
After completion, create `.planning/phases/05-menu-browsing/05-02-SUMMARY.md`
</output>
