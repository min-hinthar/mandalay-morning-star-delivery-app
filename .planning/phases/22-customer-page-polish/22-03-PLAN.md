---
phase: 22-customer-page-polish
plan: 03
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - src/app/(customer)/orders/page.tsx
  - src/components/orders/OrderCard.tsx
  - src/components/ui-v8/cart/CartDrawerV8.tsx
  - src/components/ui-v8/cart/CartItemV8.tsx
  - src/components/ui/EmptyState.tsx
autonomous: true

must_haves:
  truths:
    - "Order history items stagger individually"
    - "Order cards have glassmorphism and hover glow"
    - "Cart drawer items animate on add/remove with spring"
    - "Empty states have unique per-page illustrations"
    - "Animations replay on scroll re-enter"
  artifacts:
    - path: "src/app/(customer)/orders/page.tsx"
      provides: "Animated order history page wrapper"
      contains: "AnimatedSection"
    - path: "src/components/orders/OrderCard.tsx"
      provides: "Enhanced order card with glow"
      contains: "glow-gradient"
    - path: "src/components/ui-v8/cart/CartDrawerV8.tsx"
      provides: "Enhanced cart with spring animations"
      contains: "spring.rubbery"
  key_links:
    - from: "src/app/(customer)/orders/page.tsx"
      to: "src/components/scroll/AnimatedSection.tsx"
      via: "scroll reveal wrapper"
      pattern: "AnimatedSection"
    - from: "src/components/orders/OrderCard.tsx"
      to: "src/lib/motion-tokens.ts"
      via: "spring import"
      pattern: "spring\\."
---

<objective>
Polish Order History page with proud collection feel and enhance Cart drawer with premium animations. Update empty states with page-specific personality.

Purpose: Orders should feel like achievements to browse. Cart should feel as polished as the homepage. Empty states guide users with delight.

Output: Animated Order History with stagger and glassmorphism, polished Cart with spring physics, enhanced empty states.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/22-customer-page-polish/22-CONTEXT.md
@.planning/phases/22-customer-page-polish/22-RESEARCH.md
@.planning/phases/22-customer-page-polish/22-01-SUMMARY.md
@src/app/(customer)/orders/page.tsx
@src/components/orders/OrderCard.tsx
@src/components/ui-v8/cart/CartDrawerV8.tsx
@src/components/ui/EmptyState.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance Order History page with stagger and scroll reveal</name>
  <files>
    src/app/(customer)/orders/page.tsx
    src/components/orders/OrderCard.tsx
  </files>
  <action>
Note: Orders page is a Server Component. Animation must happen in client components.

OrderCard.tsx enhancements:
1. Add `glow-gradient` class to Card for hover glow
2. Add `glass-menu-card` class for glassmorphism
3. Update motion animation to use 80ms stagger with max cap:
```tsx
transition={{ delay: Math.min(index * 0.08, 0.5) }}
```
4. Add whileHover scale effect:
```tsx
whileHover={{ scale: 1.02, y: -4 }}
whileTap={{ scale: 0.98 }}
```
5. Add `shadow-colorful` class for premium shadow
6. Ensure exit animation for when order is removed from list (if applicable)

orders/page.tsx updates (Server Component):
1. Wrap order list in a new client component `OrderListAnimated`:
```tsx
// Create new file or inline client component
"use client";
function OrderListAnimated({ orders }) {
  return (
    <AnimatedSection as="div">
      <div className="space-y-4">
        {orders.map((order, index) => (
          <motion.div key={order.id} variants={staggerItem}>
            <OrderCard order={order} index={index} />
          </motion.div>
        ))}
      </div>
    </AnimatedSection>
  );
}
```
2. Header should fade in with slide (client component wrapper if needed)
3. Add `viewTransitionName` to the page container for View Transitions (future-proofing)
  </action>
  <verify>
Visit /orders (when logged in with order history):
- Orders stagger in individually
- Scrolling away and back replays animation
- Cards have glassmorphism blur
- Cards glow on hover
`pnpm typecheck` passes
  </verify>
  <done>Order History page has staggered cards with glassmorphism and hover glow</done>
</task>

<task type="auto">
  <name>Task 2: Polish Cart drawer with premium animations</name>
  <files>
    src/components/ui-v8/cart/CartDrawerV8.tsx
    src/components/ui-v8/cart/CartItemV8.tsx
  </files>
  <action>
CartDrawerV8.tsx enhancements:
1. Entry animation for drawer:
- Add scale from 0.98 on open for subtle depth effect
- Backdrop blur animates from 0 to 10px

2. Cart header badge bounce:
- Item count badge should use spring.rubbery for satisfying bounce when count changes
- Already has some animation, enhance the spring

3. Add sound effect on item add (optional, only if sounds enabled):
- Import useSoundEffect hook
- Play "pop" sound on successful add

4. Footer checkout button:
- Add pulsing glow when cart has items (subtle call to action)
- Use buttonPress hover preset

CartItemV8.tsx enhancements:
1. Add glassmorphism: `glass-menu-card` class
2. Add `shadow-colorful` class
3. Quantity change animation:
- Ensure using spring.rubbery from motion tokens
- Number should have satisfying flip effect

4. Remove animation (already exists, enhance):
- Slide left + scale down + fade
- Add subtle rotation: `rotate: -3`

5. Add hover state:
- Subtle lift on hover
- Show delete button more prominently
  </action>
  <verify>
Open cart drawer:
- Drawer opens with smooth scale animation
- Item count badge bounces on change
- Cart items have glassmorphism
- Quantity selector has rubbery spring
- Removing item has smooth exit animation
`pnpm typecheck` passes
  </verify>
  <done>Cart drawer has premium animations with spring physics and glassmorphism</done>
</task>

<task type="auto">
  <name>Task 3: Enhance empty states with page-specific personality</name>
  <files>src/components/ui/EmptyState.tsx</files>
  <action>
Update EmptyState component with enhanced animations and page-specific personality:

1. Add animated illustrations (CSS-based, no external images):
- Cart empty: Animated shopping bag with floating items
- Orders empty: Animated receipt with sparkles
- Search empty: Animated magnifying glass with question mark

2. Use CSS keyframes for simple animations:
```css
@keyframes float-gentle {
  0%, 100% { transform: translateY(0) rotate(0); }
  50% { transform: translateY(-8px) rotate(2deg); }
}
```

3. Add stagger to the empty state content:
- Icon fades in first
- Title slides up second
- Description slides up third
- Action button scales in last

4. Per-page personality (update variantConfigs):
- Cart: "Your cart is feeling lonely" + warm encouraging tone
- Orders: "No orders yet" + "Your culinary journey awaits"
- Search: Keep current but add animated search icon

5. Add gradient background option:
- Subtle gradient blob behind icon for visual interest
- Uses theme colors (amber/red gradient)

6. Respect useAnimationPreference:
- Animations only play if shouldAnimate is true
  </action>
  <verify>
View empty states:
- Visit /orders when no orders (if testable)
- Open cart when empty
- Search for nonexistent item on menu
- Each has distinct personality
- Animations are smooth and playful
`pnpm typecheck` passes
  </verify>
  <done>Empty states have page-specific personality with animated illustrations</done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` passes
2. `pnpm build` passes
3. Order History page shows:
   - Individual order card stagger
   - Glassmorphism on cards
   - Hover glow effect
   - Animations replay on scroll
4. Cart drawer shows:
   - Smooth open animation
   - Spring physics on quantity
   - Premium glassmorphism
   - Satisfying remove animation
5. Empty states show:
   - Animated icons
   - Staggered content reveal
   - Page-specific messaging
</verification>

<success_criteria>
- Order cards stagger individually at 80ms
- Order cards have glassmorphism and hover glow
- Cart drawer animations feel premium with spring physics
- Cart items have satisfying add/remove transitions
- Empty states have unique personality per page
- All animations respect reduced motion preference
</success_criteria>

<output>
After completion, create `.planning/phases/22-customer-page-polish/22-03-SUMMARY.md`
</output>
