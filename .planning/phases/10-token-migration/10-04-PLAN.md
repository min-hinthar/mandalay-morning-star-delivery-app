---
phase: 10-token-migration
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/layout/footer.tsx
  - src/components/cart/CartBar.tsx
  - src/components/cart/CartAnimations.tsx
  - src/components/driver/PhotoCapture.tsx
  - src/components/auth/WelcomeAnimation.tsx
  - src/components/checkout/TimeSlotPicker.tsx
  - src/components/layout/header.tsx
  - src/components/ui/FlipCard.tsx
  - src/components/admin/analytics/Charts.tsx
  - src/components/admin/analytics/PerformanceChart.tsx
autonomous: true

must_haves:
  truths:
    - "No hardcoded z-10 or zIndex: 9999 remain in remaining component files"
    - "CartAnimations uses zIndex.max token instead of 9999"
    - "Header gradients use semantic color classes (from-secondary via-primary)"
    - "FlipCard gradients use semantic color classes"
    - "Footer gradient uses documented intentional dark theme colors (not migrated - custom dark colors)"
    - "Chart color constants reference CSS custom properties"
    - "ESLint z-index rule passes with zero warnings codebase-wide"
  artifacts:
    - path: "src/components/cart/CartAnimations.tsx"
      provides: "Cart animation with zIndex.max"
      contains: "zIndex.max"
    - path: "src/components/layout/header.tsx"
      provides: "Header with semantic gradient colors"
      contains: "from-secondary"
    - path: "src/components/ui/FlipCard.tsx"
      provides: "FlipCard with semantic gradient colors"
      contains: "from-primary"
    - path: "src/components/admin/analytics/Charts.tsx"
      provides: "Charts with CSS variable colors"
      contains: "var(--color-"
  key_links:
    - from: "src/components/cart/CartAnimations.tsx"
      to: "src/design-system/tokens/z-index.ts"
      via: "import { zIndex }"
      pattern: "zIndex\\.max"
    - from: "src/components/layout/header.tsx"
      to: "src/styles/tokens.css"
      via: "Tailwind color utilities"
      pattern: "from-secondary|via-primary"
---

<objective>
Complete z-index migration for remaining files and migrate color tokens.

Purpose: Finish z-index token migration (6 files) and migrate hardcoded gradient/chart colors to semantic tokens (4 files). Validate ESLint passes with zero z-index warnings.
Output: 10 files migrated, ESLint clean.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-token-migration/10-RESEARCH.md
@src/design-system/tokens/z-index.ts
@src/styles/tokens.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate remaining z-index files</name>
  <files>
    src/components/layout/footer.tsx
    src/components/cart/CartBar.tsx
    src/components/cart/CartAnimations.tsx
    src/components/driver/PhotoCapture.tsx
    src/components/auth/WelcomeAnimation.tsx
    src/components/checkout/TimeSlotPicker.tsx
  </files>
  <action>
    **Tailwind class migrations:**
    - footer.tsx: Replace `z-10` with `z-dropdown` (2 locations)
    - CartBar.tsx: Replace `z-10` with `z-dropdown`
    - PhotoCapture.tsx: Replace `z-10` with `z-dropdown`
    - WelcomeAnimation.tsx: Replace `z-10` with `z-dropdown`
    - TimeSlotPicker.tsx: Replace `z-10` with `z-dropdown` (2 locations)

    **CartAnimations.tsx** (inline style):
    - Add import: `import { zIndex } from "@/design-system/tokens/z-index";`
    - Replace `zIndex: 9999` with `zIndex: zIndex.max`

    Pattern for CartAnimations.tsx:
    ```tsx
    // Before
    style={{ zIndex: 9999 }}

    // After
    import { zIndex } from "@/design-system/tokens/z-index";
    // ...
    style={{ zIndex: zIndex.max }}
    ```
  </action>
  <verify>
    Run: `grep -En "z-10|z-20" src/components/layout/footer.tsx src/components/cart/CartBar.tsx src/components/driver/PhotoCapture.tsx src/components/auth/WelcomeAnimation.tsx src/components/checkout/TimeSlotPicker.tsx`
    Expected: No matches

    Run: `grep -n "9999" src/components/cart/CartAnimations.tsx`
    Expected: No matches

    Run: `grep -n "zIndex.max" src/components/cart/CartAnimations.tsx`
    Expected: 1 match
  </verify>
  <done>
    6 remaining z-index files migrated. CartAnimations uses zIndex.max token instead of magic number 9999. Others use z-dropdown class.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate color tokens in header, footer, and FlipCard</name>
  <files>
    src/components/layout/header.tsx
    src/components/layout/footer.tsx
    src/components/ui/FlipCard.tsx
  </files>
  <action>
    **header.tsx gradient migration:**

    Current (line ~343-355, ornate border):
    ```tsx
    className="bg-gradient-to-r from-[#D4A017] via-[#A41034] to-[#D4A017]"
    backgroundImage: `repeating-linear-gradient(90deg, #D4A017 0px, #D4A017 4px, #A41034 4px, #A41034 8px, #D4A017 8px, #D4A017 12px)`
    ```

    Replace with:
    ```tsx
    className="bg-gradient-to-r from-secondary via-primary to-secondary"
    backgroundImage: `repeating-linear-gradient(90deg, var(--color-secondary) 0px, var(--color-secondary) 4px, var(--color-primary) 4px, var(--color-primary) 8px, var(--color-secondary) 8px, var(--color-secondary) 12px)`
    ```

    Also replace scroll progress indicator (line ~448):
    ```tsx
    // Before
    className="bg-gradient-to-r from-[#A41034] to-[#D4A017]"
    // After
    className="bg-gradient-to-r from-primary to-secondary"
    ```

    Also replace focus ring colors (lines ~80, ~171):
    ```tsx
    // Before
    focus-visible:ring-[#A41034]/30
    // After
    focus-visible:ring-primary/30
    ```

    **footer.tsx gradient:**
    The dark footer gradient `from-[#1a1a2e] via-[#16213e] to-[#0f0f23]` uses custom dark colors not in tokens. Keep as-is for now - these are intentional dark theme colors. Add comment:
    ```tsx
    {/* Dark footer gradient - intentional custom colors for dark theme */}
    className="bg-gradient-to-br from-[#1a1a2e] via-[#16213e] to-[#0f0f23]"
    ```

    **FlipCard.tsx gradient migration:**
    Replace hardcoded colors with semantic tokens:
    ```tsx
    // Before
    background: "linear-gradient(135deg, #EBCD00 0%, #D4A017 100%)"
    // After
    background: "linear-gradient(135deg, var(--color-secondary) 0%, var(--color-secondary-hover) 100%)"

    // Before
    "bg-gradient-to-br from-[#A41034] to-[#7a0c27]"
    // After
    "bg-gradient-to-br from-primary to-primary-active"

    // Before
    "border-[#A41034]/20", "shadow-[#A41034]/20"
    // After
    "border-primary/20", "shadow-primary/20"

    // SVG fills with #EBCD00 - keep as-is (SVG doesn't support CSS vars directly)
    ```
  </action>
  <verify>
    Run: `grep -n "#D4A017\|#A41034" src/components/layout/header.tsx | grep -v "//"`
    Expected: No matches outside comments

    Run: `grep -n "from-secondary\|via-primary\|from-primary" src/components/layout/header.tsx`
    Expected: Multiple matches

    Run: `grep -n "from-primary\|to-primary-active" src/components/ui/FlipCard.tsx`
    Expected: Matches showing token usage
  </verify>
  <done>
    header.tsx uses semantic color classes for gradients. FlipCard.tsx uses primary/secondary tokens. Footer dark gradient documented as intentional.
  </done>
</task>

<task type="auto">
  <name>Task 3: Migrate chart colors and verify ESLint</name>
  <files>
    src/components/admin/analytics/Charts.tsx
    src/components/admin/analytics/PerformanceChart.tsx
  </files>
  <action>
    **Charts.tsx V7_COLORS migration:**
    Update the color constants to use CSS custom properties:
    ```tsx
    const V7_COLORS = {
      primary: {
        main: "var(--color-primary)",
        light: "rgba(164, 16, 52, 0.1)", // Keep rgba for opacity
        gradient: ["rgba(164, 16, 52, 0.4)", "rgba(164, 16, 52, 0.05)"],
      },
      secondary: {
        main: "var(--color-secondary)",
        light: "rgba(235, 205, 0, 0.1)",
        gradient: ["rgba(235, 205, 0, 0.4)", "rgba(235, 205, 0, 0.05)"],
      },
      green: {
        main: "var(--color-accent-green)",
        light: "rgba(82, 165, 46, 0.1)",
        gradient: ["rgba(82, 165, 46, 0.4)", "rgba(82, 165, 46, 0.05)"],
      },
      error: {
        main: "var(--color-status-error)",
        light: "rgba(220, 38, 38, 0.1)",
        gradient: ["rgba(220, 38, 38, 0.4)", "rgba(220, 38, 38, 0.05)"],
      },
      grid: "var(--color-border-default)",
      text: "var(--color-text-secondary)",
      textMuted: "var(--color-text-muted)",
    };
    ```

    Note: rgba values kept for opacity since CSS vars don't support alpha modification.
    Rename constant to CHART_COLORS (drop V7 prefix).

    **PerformanceChart.tsx V5_CHART_COLORS:**
    ```tsx
    const CHART_COLORS = {
      primary: "var(--color-secondary)", // Was #D4A017
      secondary: "var(--color-accent-green)", // Was #2E8B57
      tertiary: "var(--color-accent-orange)", // Was #8B4513 (closest match)
      text: "var(--color-text-primary)", // Was #1A1A1A
    };
    ```

    **Final ESLint verification:**
    Run full z-index lint check to confirm zero warnings.
  </action>
  <verify>
    Run: `grep -n "var(--color-" src/components/admin/analytics/Charts.tsx | head -5`
    Expected: Multiple matches showing CSS variable usage

    Run: `grep -n "V7_COLORS\|V5_CHART_COLORS" src/components/admin/analytics/{Charts,PerformanceChart}.tsx`
    Expected: No matches (renamed to CHART_COLORS)

    Run full ESLint z-index check:
    ```bash
    pnpm lint 2>&1 | grep -c "z-index" || echo "0"
    ```
    Expected: 0 (zero z-index warnings)
  </verify>
  <done>
    Chart color constants migrated to CSS custom properties. ESLint z-index rule passes with zero warnings across entire codebase.
  </done>
</task>

</tasks>

<verification>
Final comprehensive verification:

```bash
# Z-index warnings should be 0
pnpm lint 2>&1 | grep -c "z-index" || echo "0"

# No hardcoded z-[number] patterns remain (except documented exceptions)
grep -r "z-\[" src/components --include="*.tsx" | grep -v "node_modules" | wc -l

# Token imports present where needed
grep -l "import.*zIndex" src/components/cart/CartAnimations.tsx src/components/tracking/PushToast.tsx src/components/ui/Modal.tsx
```

All three checks should pass.
</verification>

<success_criteria>
- 6 remaining z-index files migrated to tokens
- CartAnimations uses zIndex.max instead of 9999
- Header and FlipCard gradients use semantic color classes
- Chart colors use CSS custom properties
- Footer dark gradient documented as intentional
- ESLint z-index rule passes with 0 warnings codebase-wide
- All visual rendering unchanged (colors and layering identical)
</success_criteria>

<output>
After completion, create `.planning/phases/10-token-migration/10-04-SUMMARY.md`
</output>
