---
phase: 28-token-enforcement-layout
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/tokens.css
  - tailwind.config.ts
  - eslint.config.mjs
autonomous: true

must_haves:
  truths:
    - "text-2xs token (10px) exists in tokens.css for both light and dark themes"
    - "text-2xs utility is mapped in tailwind.config.ts with correct line-height"
    - "ESLint rules catch text-[Npx] arbitrary font sizes"
    - "ESLint rules catch spacing arbitrary values (p-[Npx], m-[Npx], gap-[Npx])"
  artifacts:
    - path: "src/styles/tokens.css"
      provides: "text-2xs token definition"
      contains: "--text-2xs"
    - path: "tailwind.config.ts"
      provides: "text-2xs utility mapping"
      contains: "2xs"
    - path: "eslint.config.mjs"
      provides: "Layout token enforcement rules"
      contains: "text-\\[\\d+px\\]"
  key_links:
    - from: "tailwind.config.ts"
      to: "src/styles/tokens.css"
      via: "CSS variable reference"
      pattern: "var\\(--text-2xs"
---

<objective>
Add text-2xs typography token and ESLint rules for layout token enforcement.

Purpose: Establishes infrastructure for layout token migration with small font size support
Output: text-2xs token + ESLint rules preventing arbitrary layout values
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/28-token-enforcement-layout/28-CONTEXT.md
@.planning/phases/28-token-enforcement-layout/28-RESEARCH.md
@src/styles/tokens.css
@tailwind.config.ts
@eslint.config.mjs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add text-2xs typography token</name>
  <files>src/styles/tokens.css, tailwind.config.ts</files>
  <action>
Add text-2xs token to tokens.css (both :root and .dark sections).

In :root section (after --text-xs definition ~line 196):
```css
--text-2xs: 0.625rem;    /* 10px */
--text-2xs--line-height: 1.4;
--text-2xs--letter-spacing: 0.01em;
```

In .dark section: No changes needed (font sizes don't change between themes).

In tailwind.config.ts, add to fontSize configuration (before or after "xs"):
```typescript
"2xs": [
  "var(--text-2xs)",
  {
    lineHeight: "var(--text-2xs--line-height)",
    letterSpacing: "var(--text-2xs--letter-spacing)",
  },
],
```

Note: Find the fontSize section in the theme config. The exact structure may be:
- Direct extension: `fontSize: { "2xs": [...] }`
- Inside theme.extend: `theme: { extend: { fontSize: {...} } }`
  </action>
  <verify>Run `grep "text-2xs" src/styles/tokens.css tailwind.config.ts` returns matches in both files</verify>
  <done>text-2xs token defined in CSS (0.625rem/10px) and mapped in Tailwind with appropriate line-height</done>
</task>

<task type="auto">
  <name>Task 2: Add ESLint rules for layout token enforcement</name>
  <files>eslint.config.mjs</files>
  <action>
Add ESLint rules to the "no-restricted-syntax" array in the Design Token Enforcement section (around line 124).

Add these rules after the existing color rules:

```javascript
// Typography: Catch arbitrary font sizes in Tailwind classes
{
  selector: "Literal[value=/text-\\[\\d+px\\]/]",
  message: "Use Tailwind typography scale (text-2xs, text-xs, text-sm, etc.) instead of text-[Npx]. For 10px use text-2xs.",
},
// Spacing: Catch arbitrary margin values
{
  selector: "Literal[value=/\\bm-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (m-1, m-2, m-4, etc.) or CSS variable instead of m-[Npx].",
},
{
  selector: "Literal[value=/\\bm[xy]-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (mx-1, my-2, etc.) or CSS variable instead of mx/my-[Npx].",
},
{
  selector: "Literal[value=/\\bm[trbl]-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (mt-1, mr-2, etc.) or CSS variable instead of mt/mr/mb/ml-[Npx].",
},
// Spacing: Catch arbitrary padding values
{
  selector: "Literal[value=/\\bp-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (p-1, p-2, p-4, etc.) or CSS variable instead of p-[Npx].",
},
{
  selector: "Literal[value=/\\bp[xy]-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (px-1, py-2, etc.) or CSS variable instead of px/py-[Npx].",
},
{
  selector: "Literal[value=/\\bp[trbl]-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (pt-1, pr-2, etc.) or CSS variable instead of pt/pr/pb/pl-[Npx].",
},
// Spacing: Catch arbitrary gap values
{
  selector: "Literal[value=/\\bgap-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (gap-1, gap-2, gap-4, etc.) or CSS variable instead of gap-[Npx].",
},
{
  selector: "Literal[value=/\\bgap-[xy]-\\[\\d+px\\]/]",
  message: "Use Tailwind spacing scale (gap-x-1, gap-y-2, etc.) or CSS variable instead of gap-x/y-[Npx].",
},
// Typography: Catch inline fontSize pixel values in style objects
{
  selector: "Property[key.name='fontSize'][value.value=/^\\d+px$/]",
  message: "Use Tailwind typography class or CSS variable instead of inline fontSize pixel value.",
},
// Typography: Catch inline fontWeight numeric values in style objects
{
  selector: "Property[key.name='fontWeight'][value.type='Literal'][value.raw=/^\\d+$/]",
  message: "Use Tailwind font-weight class (font-normal=400, font-medium=500, font-semibold=600, font-bold=700) instead of inline fontWeight number.",
},
```

Note: These rules allow:
- CSS variable arbitrary values: `top-[var(--header-height)]` (OK)
- Calc expressions: `top-[calc(var(--x)+16px)]` (OK)
- Position utilities: `top-[72px]` is NOT caught (position is different from spacing)
  </action>
  <verify>Run `pnpm lint 2>&1 | head -50` to verify ESLint runs without config errors</verify>
  <done>ESLint rules added for text-[Npx], m-[Npx], p-[Npx], gap-[Npx], inline fontSize, inline fontWeight</done>
</task>

</tasks>

<verification>
1. Run `pnpm typecheck` - no type errors
2. Run `pnpm lint` - ESLint runs (may show violations from existing code - this is expected)
3. Run `pnpm build` - builds successfully
4. Verify `text-2xs` class works: `grep "2xs" tailwind.config.ts` shows the mapping
</verification>

<success_criteria>
- text-2xs token (10px) defined in tokens.css
- text-2xs utility mapped in tailwind.config.ts with line-height
- ESLint catches arbitrary font size violations (text-[Npx])
- ESLint catches arbitrary spacing violations (m-[Npx], p-[Npx], gap-[Npx])
- ESLint catches inline fontSize/fontWeight in style objects
- Build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/28-token-enforcement-layout/28-01-SUMMARY.md`
</output>
