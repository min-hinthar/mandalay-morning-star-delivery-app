---
phase: 33-full-components-consolidation
plan: 11
type: execute
wave: 6
depends_on: ["33-10"]
files_modified:
  - knip.config.ts
  - src/components/ui/index.ts
autonomous: true

must_haves:
  truths:
    - "knip config reflects new directory structure"
    - "Final barrel exports complete and correct"
    - "All verification commands pass"
    - "Components root only contains ui/ directory"
  artifacts:
    - path: "knip.config.ts"
      provides: "Updated entry points for knip"
    - path: "src/components/ui/index.ts"
      provides: "Complete barrel export for all ui components"
  key_links:
    - from: "barrel export"
      to: "all subdirectories"
      via: "re-export"
      pattern: "export \\* from"
---

<objective>
Update knip config and finalize barrel exports.

Purpose: Complete consolidation housekeeping - update tooling config and ensure exports are complete
Output: Correct knip configuration, complete ui/index.ts barrel
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@knip.config.ts
@src/components/ui/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update knip configuration</name>
  <files>
    knip.config.ts
  </files>
  <action>
    Read current knip.config.ts and update entry points to reflect new structure.

    Ensure knip knows about:
    - src/components/ui/**/*.tsx (all components now under ui/)
    - Removed directories no longer in entry points
    - Any ignore patterns needed for storybook files

    Run knip to verify configuration:
    npx knip --include files

    Should return empty or minimal results (no false positives from consolidation).
  </action>
  <verify>
    npx knip --include files returns clean results
    knip.config.ts syntax is valid
  </verify>
  <done>
    knip config updated for new structure
  </done>
</task>

<task type="auto">
  <name>Task 2: Finalize ui/index.ts barrel exports</name>
  <files>
    src/components/ui/index.ts
  </files>
  <action>
    Ensure ui/index.ts re-exports all subdirectories and primitives.

    Final structure should include:
    ```typescript
    // Primitives at ui/ root
    export * from "./button";
    export * from "./Modal";
    export * from "./Drawer";
    // ... existing primitive exports ...

    // Layout primitives (moved from layouts/)
    export { Stack } from "./Stack";
    export { Grid } from "./Grid";
    export { Container } from "./Container";
    export { Cluster } from "./Cluster";
    export { SafeArea } from "./SafeArea";

    // Subdirectory re-exports
    export * from "./admin";
    export * from "./auth";
    export * from "./brand";
    export * from "./cart";
    export * from "./checkout";
    export * from "./driver";
    export * from "./homepage";
    export * from "./layout";
    export * from "./menu";
    export * from "./navigation";
    export * from "./orders";
    export * from "./scroll";
    export * from "./search";
    export * from "./theme";
    export * from "./transitions";
    ```

    Verify each subdirectory has an index.ts that exports its components.
  </action>
  <verify>
    pnpm typecheck passes
    pnpm build passes
    No circular dependency warnings
  </verify>
  <done>
    ui/index.ts barrel complete
  </done>
</task>

<task type="auto">
  <name>Task 3: Final verification and cleanup</name>
  <files>
    src/components/
  </files>
  <action>
    1. Verify components/ root only contains ui/:
       ls src/components/
       Should show only: ui/

    2. Run full verification suite:
       pnpm lint && pnpm lint:css && pnpm typecheck && pnpm build

    3. Verify no imports to removed paths remain:
       grep -rn "from.*@/components/[^u]" src/ --include="*.tsx" --include="*.ts" | grep -v "ui"
       Should return empty.

    4. Count final structure:
       find src/components/ui -type d | wc -l  # subdirectory count
       find src/components/ui -name "*.tsx" | wc -l  # component count
  </action>
  <verify>
    ls src/components shows only ui/
    All verification commands pass
    No imports to removed directories
  </verify>
  <done>
    Phase 33 consolidation complete and verified
  </done>
</task>

</tasks>

<verification>
- pnpm lint passes
- pnpm lint:css passes
- pnpm typecheck passes
- pnpm build passes
- npx knip --include files returns clean
- Components root only contains ui/
</verification>

<success_criteria>
- knip config reflects new structure
- ui/index.ts exports all subdirectories
- All verification commands pass
- Consolidation complete: only ui/ remains at components/
</success_criteria>

<output>
After completion, create `.planning/phases/33-full-components-consolidation/33-11-SUMMARY.md`
</output>
