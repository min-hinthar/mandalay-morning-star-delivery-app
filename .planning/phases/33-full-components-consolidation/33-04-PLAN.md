---
phase: 33-full-components-consolidation
plan: 04
type: execute
wave: 2
depends_on: ["33-01"]
files_modified:
  - src/components/layout/
  - src/components/layouts/
  - src/components/ui/layout/
  - src/components/ui/search/
  - src/components/ui/Stack.tsx
  - src/components/ui/Grid.tsx
  - src/components/ui/Container.tsx
autonomous: true

must_haves:
  truths:
    - "All layout components available from @/components/ui/layout"
    - "Primitives (Stack, Grid, Container) at ui/ root"
    - "CommandPalette available from @/components/ui/search"
    - "layout/ and layouts/ directories no longer exist"
  artifacts:
    - path: "src/components/ui/layout/"
      provides: "App header, layouts, mobile drawer"
    - path: "src/components/ui/search/"
      provides: "CommandPalette component"
    - path: "src/components/ui/Stack.tsx"
      provides: "Stack layout primitive"
    - path: "src/components/ui/Grid.tsx"
      provides: "Grid layout primitive"
    - path: "src/components/ui/Container.tsx"
      provides: "Container layout primitive"
  key_links:
    - from: "consumers"
      to: "@/components/ui/layout"
      via: "import"
      pattern: "from.*@/components/ui/layout"
---

<objective>
Merge layout/ and layouts/ into ui/layout/, move primitives to ui/ root.

Purpose: Consolidate two layout directories and distribute components per CONTEXT.md decisions
Output: ui/layout/ for app layouts, ui/search/ for CommandPalette, primitives at ui/ root
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/33-full-components-consolidation/33-CONTEXT.md
@.planning/phases/33-full-components-consolidation/33-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Move layout primitives to ui/ root</name>
  <files>
    src/components/layouts/Stack.tsx
    src/components/layouts/Stack.stories.tsx
    src/components/layouts/Grid.tsx
    src/components/layouts/Grid.stories.tsx
    src/components/layouts/Container.tsx
    src/components/layouts/Container.stories.tsx
    src/components/layouts/Cluster.tsx
    src/components/layouts/SafeArea.tsx
    src/components/ui/Stack.tsx
    src/components/ui/Grid.tsx
    src/components/ui/Container.tsx
    src/components/ui/Cluster.tsx
    src/components/ui/SafeArea.tsx
  </files>
  <action>
    Move layout primitives from layouts/ to ui/ root (per CONTEXT.md: "Primitives at ui/ root"):
    - layouts/Stack.tsx -> ui/Stack.tsx
    - layouts/Stack.stories.tsx -> ui/Stack.stories.tsx
    - layouts/Grid.tsx -> ui/Grid.tsx
    - layouts/Grid.stories.tsx -> ui/Grid.stories.tsx
    - layouts/Container.tsx -> ui/Container.tsx
    - layouts/Container.stories.tsx -> ui/Container.stories.tsx
    - layouts/Cluster.tsx -> ui/Cluster.tsx
    - layouts/SafeArea.tsx -> ui/SafeArea.tsx

    Update any internal imports to use new paths.
  </action>
  <verify>
    Files exist at ui/ root
    pnpm typecheck passes
  </verify>
  <done>
    5 layout primitives + 3 stories files moved to ui/ root
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ui/layout/ and move app layouts</name>
  <files>
    src/components/layouts/AdminLayout.tsx
    src/components/layouts/CheckoutLayout.tsx
    src/components/layouts/DriverLayout.tsx
    src/components/layout/AppHeader/
    src/components/layout/HeaderWrapper.tsx
    src/components/layout/MobileDrawer/
    src/components/ui/layout/
  </files>
  <action>
    Create ui/layout/ directory and move app-specific layouts:

    From layouts/:
    - AdminLayout.tsx -> ui/layout/AdminLayout.tsx
    - CheckoutLayout.tsx -> ui/layout/CheckoutLayout.tsx
    - DriverLayout.tsx -> ui/layout/DriverLayout.tsx

    From layout/:
    - AppHeader/ (entire directory) -> ui/layout/AppHeader/
    - HeaderWrapper.tsx -> ui/layout/HeaderWrapper.tsx
    - MobileDrawer/ (entire directory) -> ui/layout/MobileDrawer/

    Update internal imports in moved files.
  </action>
  <verify>
    All files exist in ui/layout/
    pnpm typecheck passes
  </verify>
  <done>
    App headers, layouts, and mobile drawer in ui/layout/
  </done>
</task>

<task type="auto">
  <name>Task 3: Create ui/search/ with CommandPalette</name>
  <files>
    src/components/layout/CommandPalette/
    src/components/ui/search/
  </files>
  <action>
    Create ui/search/ directory (per CONTEXT.md: "CommandPalette to ui/search/"):
    - Move layout/CommandPalette/ -> ui/search/CommandPalette/

    Create ui/search/index.ts:
    ```typescript
    export { CommandPalette } from "./CommandPalette";
    ```

    Update internal imports in CommandPalette files.
  </action>
  <verify>
    CommandPalette accessible from @/components/ui/search
    pnpm typecheck passes
  </verify>
  <done>
    CommandPalette lives in ui/search/
  </done>
</task>

</tasks>

<verification>
- pnpm build passes
- pnpm typecheck passes
- pnpm lint passes
- Stack, Grid, Container importable from @/components/ui
- AdminLayout, CheckoutLayout, DriverLayout importable from @/components/ui/layout
- CommandPalette importable from @/components/ui/search
</verification>

<success_criteria>
- Primitives (Stack, Grid, Container, Cluster, SafeArea) at ui/ root
- App layouts in ui/layout/
- CommandPalette in ui/search/
- layout/ and layouts/ directories ready for deletion in next plan
</success_criteria>

<output>
After completion, create `.planning/phases/33-full-components-consolidation/33-04-SUMMARY.md`
</output>
