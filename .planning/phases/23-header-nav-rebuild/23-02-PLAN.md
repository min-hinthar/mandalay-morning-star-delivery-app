---
phase: 23-header-nav-rebuild
plan: 02
type: execute
wave: 2
depends_on: [23-01]
files_modified:
  - src/components/layout/AppHeader/AppHeader.tsx
  - src/components/layout/AppHeader/DesktopHeader.tsx
  - src/components/layout/AppHeader/MobileHeader.tsx
  - src/components/layout/AppHeader/HeaderNavLink.tsx
  - src/components/layout/AppHeader/index.ts
autonomous: true

must_haves:
  truths:
    - "Header hides on scroll down, reappears on scroll up"
    - "Desktop header shows icon-based nav links with text labels"
    - "Mobile header shows hamburger button and cart icon"
    - "Header has glassmorphism blur background"
    - "Nav links have multi-layered hover states"
  artifacts:
    - path: "src/components/layout/AppHeader/AppHeader.tsx"
      provides: "Main header orchestrator"
      exports: ["AppHeader"]
    - path: "src/components/layout/AppHeader/DesktopHeader.tsx"
      provides: "Desktop-specific layout"
      exports: ["DesktopHeader"]
    - path: "src/components/layout/AppHeader/MobileHeader.tsx"
      provides: "Mobile-specific layout"
      exports: ["MobileHeader"]
    - path: "src/components/layout/AppHeader/HeaderNavLink.tsx"
      provides: "Multi-layer hover nav link"
      exports: ["HeaderNavLink"]
  key_links:
    - from: "AppHeader.tsx"
      to: "useHeaderVisibility"
      via: "hook import for scroll behavior"
      pattern: "useHeaderVisibility"
    - from: "HeaderNavLink.tsx"
      to: "framer-motion"
      via: "multi-layer hover animations"
      pattern: "whileHover.*scale|rotate"
---

<objective>
Build AppHeader foundation with desktop/mobile layouts and glassmorphism styling.

Purpose: Create the core header structure that will house navigation, cart, account, and search controls.
Output: AppHeader component with responsive desktop/mobile layouts, hide-on-scroll, and glassmorphism.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/23-header-nav-rebuild/23-CONTEXT.md
@.planning/phases/23-header-nav-rebuild/23-RESEARCH.md

@src/lib/hooks/useHeaderVisibility.ts (after Plan 01)
@src/lib/motion-tokens.ts
@src/components/layout/header.tsx
@src/design-system/tokens/z-index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create HeaderNavLink with multi-layer hover states</name>
  <files>
    - src/components/layout/AppHeader/HeaderNavLink.tsx
  </files>
  <action>
Create `src/components/layout/AppHeader/HeaderNavLink.tsx`:

```tsx
interface HeaderNavLinkProps {
  href: string;
  label: string;
  icon: React.ReactNode;
  isActive?: boolean;
}
```

Multi-layer hover implementation per RESEARCH.md:
1. Background highlight - motion.span with absolute inset-0, bg-primary/5, opacity 0->1 on hover
2. Icon + label lift - motion.span with whileHover y: -2, spring.snappy
3. Icon wiggle - motion.span with whileHover rotate: [-5, 5, 0], duration 0.3
4. Animated underline - motion.span with absolute bottom-0, bg-primary, width 0->60% on hover, spring.ultraBouncy

Use Link from next/link, useAnimationPreference for reduced motion support.
Active state: underline stays visible, text-primary color.
Use zClass.dropdown for any dropdown needs (placeholder for now).
  </action>
  <verify>
    - TypeScript compiles: `pnpm typecheck`
    - Component renders without errors (visual check during integration)
  </verify>
  <done>HeaderNavLink has background highlight, icon lift/wiggle, and animated underline on hover</done>
</task>

<task type="auto">
  <name>Task 2: Create DesktopHeader, MobileHeader, and AppHeader orchestrator</name>
  <files>
    - src/components/layout/AppHeader/DesktopHeader.tsx
    - src/components/layout/AppHeader/MobileHeader.tsx
    - src/components/layout/AppHeader/AppHeader.tsx
    - src/components/layout/AppHeader/index.ts
  </files>
  <action>
1. Create `src/components/layout/AppHeader/DesktopHeader.tsx`:
   - Props: navItems, rightContent
   - Layout: Logo left, nav center (using HeaderNavLink), rightContent right
   - Nav items: Menu (UtensilsCrossed), Orders (Package), Account (User) from lucide-react
   - Use flex with items-center justify-between

2. Create `src/components/layout/AppHeader/MobileHeader.tsx`:
   - Props: onMenuToggle, isMobileMenuOpen, rightContent
   - Layout: Hamburger left (placeholder button for now), Logo center, Cart/Account right
   - Use MorphingMenu for hamburger (import from @/components/ui/MorphingMenu)
   - Compact logo variant (just image, no text on mobile)

3. Create `src/components/layout/AppHeader/AppHeader.tsx`:
   - Import useHeaderVisibility, useMediaQuery, getHeaderTransition
   - Props: onMobileMenuToggle, isMobileMenuOpen, onSearchOpen, overlayOpen
   - motion.header with:
     - animate: y: isVisible ? 0 : -72 (header height)
     - transition: getHeaderTransition(isFastScroll)
   - Glassmorphism styles per RESEARCH.md:
     - backgroundColor: rgba(255,255,255,0.75) / dark: rgba(24,24,27,0.75)
     - backdropFilter: blur(30px)
     - borderBottom: 1px solid rgba(255,255,255,0.2) / dark: rgba(255,255,255,0.05)
     - boxShadow with gradient accent
   - Height: h-16 (64px), max-w-7xl container
   - Use zClass.fixed for z-index
   - Conditional render: DesktopHeader (md:flex) vs MobileHeader (md:hidden)
   - Pass overlayOpen to useHeaderVisibility to pin header when overlays open

4. Create `src/components/layout/AppHeader/index.ts`:
   - Export AppHeader as default and named
   - Export HeaderNavLink for customization
  </action>
  <verify>
    - `pnpm typecheck` passes
    - `pnpm lint` passes
    - All components render (test in browser during integration)
  </verify>
  <done>AppHeader with velocity-aware hide/show, glassmorphism, desktop/mobile layouts</done>
</task>

</tasks>

<verification>
- `pnpm typecheck` passes
- `pnpm lint` passes
- AppHeader directory structure: AppHeader.tsx, DesktopHeader.tsx, MobileHeader.tsx, HeaderNavLink.tsx, index.ts
- Components use motion from framer-motion
- Glassmorphism CSS applied (blur, opacity, border)
</verification>

<success_criteria>
- AppHeader hides/shows based on scroll direction
- Fast scroll = instant hide, slow scroll = spring animation
- Desktop shows nav links with multi-layer hover effects
- Mobile shows hamburger and compact logo
- Glassmorphism blur consistent in light and dark modes
</success_criteria>

<output>
After completion, create `.planning/phases/23-header-nav-rebuild/23-02-SUMMARY.md`
</output>
