---
phase: 23-header-nav-rebuild
plan: 03
type: execute
wave: 2
depends_on: [23-01]
files_modified:
  - src/components/layout/MobileDrawer/MobileDrawer.tsx
  - src/components/layout/MobileDrawer/DrawerNavLink.tsx
  - src/components/layout/MobileDrawer/DrawerUserSection.tsx
  - src/components/layout/MobileDrawer/DrawerFooter.tsx
  - src/components/layout/MobileDrawer/index.ts
autonomous: true

must_haves:
  truths:
    - "Drawer slides from left"
    - "Swipe left gesture closes drawer"
    - "Tap outside closes drawer"
    - "Nav links reveal with 80ms stagger"
    - "User section shows avatar/initials when logged in"
  artifacts:
    - path: "src/components/layout/MobileDrawer/MobileDrawer.tsx"
      provides: "Main drawer with swipe-to-close"
      exports: ["MobileDrawer"]
    - path: "src/components/layout/MobileDrawer/DrawerNavLink.tsx"
      provides: "Touch-friendly nav item"
      exports: ["DrawerNavLink"]
    - path: "src/components/layout/MobileDrawer/DrawerUserSection.tsx"
      provides: "User avatar/name section"
      exports: ["DrawerUserSection"]
    - path: "src/components/layout/MobileDrawer/DrawerFooter.tsx"
      provides: "Social/contact links"
      exports: ["DrawerFooter"]
  key_links:
    - from: "MobileDrawer.tsx"
      to: "useSwipeToClose"
      via: "swipe gesture hook"
      pattern: "useSwipeToClose.*direction.*left"
    - from: "DrawerNavLink.tsx"
      to: "staggerItem variants"
      via: "80ms stagger animation"
      pattern: "variants.*staggerItem"
---

<objective>
Build MobileDrawer with left-slide animation, swipe-to-close, and staggered nav reveal.

Purpose: Provide mobile navigation that matches the playful UI aesthetic with smooth gestures.
Output: MobileDrawer component with user section, nav links, footer, swipe gestures, and staggered animations.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/23-header-nav-rebuild/23-CONTEXT.md
@.planning/phases/23-header-nav-rebuild/23-RESEARCH.md

@src/lib/swipe-gestures.ts
@src/lib/motion-tokens.ts
@src/components/layout/MobileNav.tsx
@src/components/ui/MorphingMenu.tsx
@src/components/ui/theme-toggle.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DrawerNavLink and DrawerUserSection components</name>
  <files>
    - src/components/layout/MobileDrawer/DrawerNavLink.tsx
    - src/components/layout/MobileDrawer/DrawerUserSection.tsx
  </files>
  <action>
1. Create `src/components/layout/MobileDrawer/DrawerNavLink.tsx`:
   ```tsx
   interface DrawerNavLinkProps {
     href: string;
     label: string;
     icon: React.ReactNode;
     isActive?: boolean;
     onClick?: () => void;
   }
   ```
   - Use motion.div with variants={staggerItem} for animation
   - Large touch targets: min-h-[56px] py-4 px-4
   - Icon container: w-10 h-10 rounded-lg bg-surface-tertiary
   - Active state: bg-primary/10 text-primary, icon container glows
   - whileHover x: 8, whileTap scale: 0.98
   - Use spring.snappy for transitions

2. Create `src/components/layout/MobileDrawer/DrawerUserSection.tsx`:
   ```tsx
   interface DrawerUserSectionProps {
     user: { name?: string; email?: string; avatar?: string } | null;
     onClose: () => void;
   }
   ```
   - If user: Show avatar (image or initials fallback) + name + email
   - Avatar: w-12 h-12 rounded-xl, gradient background for initials
   - Status dot: absolute w-3 h-3 rounded-full bg-green-500 with ring
   - If no user: Show "Sign In" button linking to /auth/login
   - Entrance animation: opacity 0 y: -10 -> opacity 1 y: 0
  </action>
  <verify>
    - `pnpm typecheck` passes
    - Components have proper touch target sizes
  </verify>
  <done>DrawerNavLink has 56px touch targets and stagger animation, DrawerUserSection shows user or sign-in</done>
</task>

<task type="auto">
  <name>Task 2: Create DrawerFooter and MobileDrawer main component</name>
  <files>
    - src/components/layout/MobileDrawer/DrawerFooter.tsx
    - src/components/layout/MobileDrawer/MobileDrawer.tsx
    - src/components/layout/MobileDrawer/index.ts
  </files>
  <action>
1. Create `src/components/layout/MobileDrawer/DrawerFooter.tsx`:
   - Social/contact links: About, Contact, FAQ
   - Use FooterLink from @/components/ui/AnimatedLink
   - Copyright text at bottom
   - Entrance animation with delay 0.3

2. Create `src/components/layout/MobileDrawer/MobileDrawer.tsx`:
   ```tsx
   interface MobileDrawerProps {
     isOpen: boolean;
     onClose: () => void;
     user?: { name?: string; email?: string; avatar?: string } | null;
   }
   ```
   - Use useSwipeToClose from @/lib/swipe-gestures with direction: "left", threshold: 100
   - AnimatePresence wrapper for open/close
   - Backdrop: fixed inset-0, bg-black/40 + backdrop-filter blur(8px), onClick closes
   - Drawer panel:
     - fixed left-0 top-0 bottom-0 w-[85%] max-w-sm
     - bg-white dark:bg-zinc-900 rounded-r-2xl shadow-2xl
     - animate: x: isOpen ? 0 : "-100%"
     - transition: spring.default
     - Apply motionProps from useSwipeToClose for drag gesture
     - style: touchAction "pan-y" on content to avoid scroll conflicts
   - Safe area: pt-safe for notch handling via env(safe-area-inset-top)
   - Structure: DrawerUserSection at top, nav links in scrollable middle, DrawerFooter at bottom
   - Nav items: Home, Menu, Orders, Account (same as MobileNav.tsx)
   - Stagger container: variants={staggerContainer80(0.15)} on nav section
   - Include ThemeToggle near close button area (drawer header)
   - Body scroll lock: useEffect to set document.body.style.overflow = "hidden" when open
   - Escape key closes drawer
   - Use zClass.modal for drawer panel, zClass.modalBackdrop for backdrop

3. Create `src/components/layout/MobileDrawer/index.ts`:
   - Export MobileDrawer as default and named
   - Export sub-components for customization
  </action>
  <verify>
    - `pnpm typecheck` passes
    - `pnpm lint` passes
    - Swipe left gesture closes drawer (test in browser)
    - 80ms stagger visible on nav links
  </verify>
  <done>MobileDrawer slides from left with swipe-to-close, staggered links, user section, and footer</done>
</task>

</tasks>

<verification>
- `pnpm typecheck` passes
- `pnpm lint` passes
- MobileDrawer directory structure complete
- useSwipeToClose imported with direction: "left"
- staggerContainer80 used for nav links
- Body scroll locked when open
</verification>

<success_criteria>
- Drawer slides from left (x: -100% to 0)
- Swipe left gesture (100px threshold) closes drawer
- Tap outside (backdrop) closes drawer
- Escape key closes drawer
- Nav links stagger in at 80ms intervals
- User section shows avatar or sign-in button
- Theme toggle accessible in drawer
- Safe area padding for notch devices
</success_criteria>

<output>
After completion, create `.planning/phases/23-header-nav-rebuild/23-03-SUMMARY.md`
</output>
