---
phase: 13-legacy-removal-stricter-rules
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - e2e/sprint-1-bugfixes.spec.ts
  - src/app/api/addresses/[id]/default/route.ts
  - src/app/api/addresses/[id]/route.ts
  - src/app/api/admin/analytics/drivers/[driverId]/route.ts
  - src/app/api/admin/categories/[id]/route.ts
  - src/app/api/admin/drivers/[id]/route.ts
  - src/app/api/admin/menu/[id]/route.ts
  - src/app/api/admin/routes/[id]/route.ts
  - src/app/api/driver/routes/[routeId]/route.ts
  - src/app/api/driver/routes/[routeId]/start/route.ts
  - src/app/api/orders/[id]/cancel/route.ts
  - src/app/api/orders/[id]/rating/route.ts
  - src/app/api/orders/[id]/retry-payment/route.ts
  - src/app/api/tracking/[orderId]/route.ts
  - src/app/api/webhooks/stripe/route.ts
autonomous: true

must_haves:
  truths:
    - "All API route files pass TypeScript strict checks"
    - "E2E test file has no unused variable errors"
  artifacts:
    - path: "src/app/api/**/*.ts"
      provides: "API routes with prefixed unused params"
      contains: "_request"
  key_links:
    - from: "API routes"
      to: "TypeScript compiler"
      via: "noUnusedParameters check"
      pattern: "_request.*Request"
---

<objective>
Fix TypeScript unused variable violations in API routes and E2E test file.

Purpose: Prepare API layer for TypeScript strict flags by prefixing unused `request` parameters with underscore.

Output: 14 API route files + 1 E2E test file with zero unused variable violations.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-legacy-removal-stricter-rules/13-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix unused request params in API routes</name>
  <files>
    - src/app/api/addresses/[id]/default/route.ts
    - src/app/api/addresses/[id]/route.ts
    - src/app/api/admin/analytics/drivers/[driverId]/route.ts
    - src/app/api/admin/categories/[id]/route.ts
    - src/app/api/admin/drivers/[id]/route.ts
    - src/app/api/admin/menu/[id]/route.ts
    - src/app/api/admin/routes/[id]/route.ts
    - src/app/api/driver/routes/[routeId]/route.ts
    - src/app/api/driver/routes/[routeId]/start/route.ts
    - src/app/api/orders/[id]/cancel/route.ts
    - src/app/api/orders/[id]/rating/route.ts
    - src/app/api/orders/[id]/retry-payment/route.ts
    - src/app/api/tracking/[orderId]/route.ts
    - src/app/api/webhooks/stripe/route.ts
  </files>
  <action>
Prefix unused `request` parameters with underscore in all API route handlers:

```typescript
// Before:
export async function GET(request: Request, { params }: Props) {
// After:
export async function GET(_request: Request, { params }: Props) {
```

Apply to all GET, POST, PUT, PATCH, DELETE handlers where `request` param is declared but not used.

For stripe webhook route.ts line 195: check if `supabase` variable is used. If not, prefix with `_supabase`.
  </action>
  <verify>
`npx tsc --noUnusedLocals --noUnusedParameters --noEmit 2>&1 | grep -E "api.*route.ts" | wc -l` returns 0
  </verify>
  <done>All 14 API route files have unused request params prefixed with underscore.</done>
</task>

<task type="auto">
  <name>Task 2: Fix unused variables in E2E test</name>
  <files>e2e/sprint-1-bugfixes.spec.ts</files>
  <action>
Check for unused variables in the E2E test file:
- `_initialScrollY`, `_stepLabels`, `_reviewExists`, `_payStepVisible`, `_hasAuthUI`

If any are missing the underscore prefix, add it. If any are completely unused (not even assigned), remove them.

Run tsc check on this file specifically after changes.
  </action>
  <verify>
`npx tsc --noUnusedLocals --noUnusedParameters --noEmit 2>&1 | grep "sprint-1-bugfixes" | wc -l` returns 0
  </verify>
  <done>E2E test file has no unused variable violations.</done>
</task>

</tasks>

<verification>
Run after all tasks:
```bash
npx tsc --noUnusedLocals --noUnusedParameters --noEmit 2>&1 | grep -E "(api.*route|sprint-1-bugfixes)" | wc -l
```
Expected: 0 (no errors in API routes or E2E test)
</verification>

<success_criteria>
- [ ] All 14 API route files have `_request` instead of `request` where unused
- [ ] E2E test file has no TS6133 errors
- [ ] `npx tsc --noUnusedLocals --noUnusedParameters --noEmit` shows no errors for these files
</success_criteria>

<output>
After completion, create `.planning/phases/13-legacy-removal-stricter-rules/13-01-SUMMARY.md`
</output>
