---
phase: 13-legacy-removal-stricter-rules
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - tsconfig.json
  - e2e/sprint-1-bugfixes.spec.ts
  - src/app/api/addresses/[id]/default/route.ts
  - src/app/api/addresses/[id]/route.ts
  - src/app/api/admin/analytics/drivers/[driverId]/route.ts
  - src/app/api/admin/categories/[id]/route.ts
  - src/app/api/admin/drivers/[id]/route.ts
  - src/app/api/admin/menu/[id]/route.ts
  - src/app/api/admin/routes/[id]/route.ts
  - src/app/api/driver/routes/[routeId]/route.ts
  - src/app/api/driver/routes/[routeId]/start/route.ts
  - src/app/api/orders/[id]/cancel/route.ts
  - src/app/api/orders/[id]/rating/route.ts
  - src/app/api/orders/[id]/retry-payment/route.ts
  - src/app/api/tracking/[orderId]/route.ts
  - src/app/api/webhooks/stripe/route.ts
  - src/components/admin/OrderManagement.tsx
  - src/components/admin/RouteOptimization.tsx
  - src/components/admin/analytics/Charts.tsx
  - src/components/admin/analytics/DriverLeaderboard.tsx
  - src/components/admin/analytics/PeakHoursChart.tsx
  - src/components/auth/MagicLinkSent.tsx
  - src/components/checkout/AddressInput.tsx
  - src/components/checkout/CheckoutStepperV8.tsx
  - src/components/checkout/TimeSlotPicker.tsx
  - src/components/driver/DeliverySuccess.tsx
  - src/components/driver/Leaderboard.tsx
  - src/components/homepage/FloatingFood.tsx
  - src/components/layouts/CheckoutLayout.tsx
  - src/components/layouts/PageTransition.tsx
  - src/components/mascot/BrandMascot.tsx
  - src/components/menu/CategoryCarousel.tsx
  - src/components/menu/ItemDetail.tsx
  - src/components/menu/MenuLayout.tsx
  - src/components/menu/ModifierToggle.tsx
  - src/components/menu/VisualPreview.tsx
  - src/components/theme/DynamicThemeProvider.tsx
  - src/components/tracking/ETACountdown.tsx
  - src/components/tracking/TrackingMap.tsx
  - src/components/ui-v8/cart/CartItemV8.tsx
  - src/components/ui-v8/cart/FlyToCart.tsx
  - src/components/ui-v8/cart/QuantitySelector.tsx
  - src/components/ui-v8/menu/EmojiPlaceholder.tsx
  - src/components/ui-v8/menu/MenuGridV8.tsx
  - src/components/ui-v8/menu/MenuItemCardV8.tsx
  - src/components/ui/AnimatedLink.tsx
  - src/components/ui/MorphingMenu.tsx
  - src/components/ui/PriceTicker.tsx
  - src/components/ui/skeleton.tsx
  - src/lib/services/route-optimization.ts
  - src/lib/utils/order.ts
  - src/lib/web-vitals.ts
autonomous: true

must_haves:
  truths:
    - "TypeScript builds with noUnusedLocals enabled"
    - "TypeScript builds with noUnusedParameters enabled"
    - "pnpm typecheck passes with zero errors"
  artifacts:
    - path: "tsconfig.json"
      provides: "Stricter TypeScript configuration"
      contains: "noUnusedLocals"
  key_links:
    - from: "tsconfig.json"
      to: "all .ts/.tsx files"
      via: "TypeScript compilation"
      pattern: "noUnusedLocals.*true"
---

<objective>
Fix all TypeScript unused variable violations and enable stricter compiler flags.

Purpose: Enable noUnusedLocals and noUnusedParameters in tsconfig.json to catch dead code at compile time. This prevents regression by making unused variables a build error.

Output: tsconfig.json with strict flags enabled, all 51 affected files fixed, typecheck passing.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-legacy-removal-stricter-rules/13-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix unused variable violations (51 files)</name>
  <files>
    - e2e/sprint-1-bugfixes.spec.ts
    - src/app/api/*/route.ts (14 files)
    - src/components/**/*.tsx (32 files)
    - src/lib/**/*.ts (3 files)
  </files>
  <action>
Fix all 67 TypeScript unused variable violations using these patterns:

**Pattern A: Remove unused React imports (modern JSX transform)**
```typescript
// Remove this line entirely:
import React from 'react';
```
Files: OrderManagement.tsx, RouteOptimization.tsx, Charts.tsx, MagicLinkSent.tsx, AddressInput.tsx, TimeSlotPicker.tsx, DeliverySuccess.tsx, Leaderboard.tsx, FloatingFood.tsx, PageTransition.tsx, BrandMascot.tsx, CategoryCarousel.tsx, ItemDetail.tsx, and others with unused React import.

**Pattern B: Prefix unused API request parameters with underscore**
```typescript
// Before:
export async function GET(request: Request, { params }: Props) {
// After:
export async function GET(_request: Request, { params }: Props) {
```
Files: All API route files (14 files) with unused `request` parameter.

**Pattern C: Prefix or remove other unused variables**
- `_initialScrollY`, `_stepLabels`, `_reviewExists`, `_payStepVisible`, `_hasAuthUI` in e2e tests (prefix with _ already done, verify)
- `_V5_CHART_COLORS` in DriverLeaderboard.tsx (prefix already done)
- `entry` param in PeakHoursChart.tsx line 96 - prefix with `_entry`
- `_Icon` in CheckoutStepperV8.tsx (prefix already done)
- `_isFuture` in CheckoutLayout.tsx (prefix already done)
- `_x` in CategoryCarousel.tsx (prefix already done)
- `supabase` in stripe webhook route.ts line 195 - prefix with `_supabase` if unused, or remove if truly dead

Run `npx tsc --noUnusedLocals --noUnusedParameters --noEmit` after each batch to verify progress.
  </action>
  <verify>
`npx tsc --noUnusedLocals --noUnusedParameters --noEmit 2>&1 | grep -c "TS6133"` returns 0
  </verify>
  <done>All 67 unused variable violations fixed - zero TS6133 errors when running tsc with strict flags.</done>
</task>

<task type="auto">
  <name>Task 2: Enable TypeScript strict flags</name>
  <files>tsconfig.json</files>
  <action>
Add stricter TypeScript compiler options to tsconfig.json:

```json
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noEmit": true,
    // ... rest unchanged
  }
}
```

Add `"noUnusedLocals": true` and `"noUnusedParameters": true` after the existing `"strict": true` line.
  </action>
  <verify>
`pnpm typecheck` passes with exit code 0
  </verify>
  <done>tsconfig.json has noUnusedLocals and noUnusedParameters enabled, typecheck passes.</done>
</task>

</tasks>

<verification>
Run after all tasks:
```bash
pnpm typecheck
```
Expected: Exit code 0, no errors.

Verify strict flags active:
```bash
grep -E "noUnused" tsconfig.json
```
Expected: Both flags present and set to true.
</verification>

<success_criteria>
- [ ] tsconfig.json contains `"noUnusedLocals": true`
- [ ] tsconfig.json contains `"noUnusedParameters": true`
- [ ] `pnpm typecheck` passes with zero errors
- [ ] No unused React imports remain in component files
- [ ] All API route unused request params prefixed with underscore
</success_criteria>

<output>
After completion, create `.planning/phases/13-legacy-removal-stricter-rules/13-01-SUMMARY.md`
</output>
