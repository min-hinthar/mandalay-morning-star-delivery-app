---
phase: 13-legacy-removal-stricter-rules
plan: 06
type: execute
wave: 3
depends_on: [13-05]
files_modified:
  - eslint.config.mjs
  - src/components/ui-v8/Modal.tsx
  - src/components/homepage/FloatingFood.tsx
  - src/components/homepage/Hero.tsx
  - src/components/admin/v7-index.ts (delete)
  - src/components/cart/v7-index.ts (delete)
  - src/components/checkout/v7-index.ts (delete)
  - src/components/driver/v7-index.ts (delete)
  - src/components/homepage/v7-index.ts (delete)
  - src/components/layout/v7-index.ts (delete)
  - src/components/layouts/v7-index.ts (delete)
  - src/components/menu/v7-index.ts (delete)
  - src/components/tracking/v7-index.ts (delete)
  - src/components/ui/v7-index.ts (delete)
autonomous: true

must_haves:
  truths:
    - "ESLint z-index rule enforces error severity"
    - "pnpm lint passes with zero z-index violations"
    - "No v7-index.ts files exist in codebase"
    - "Full build passes with all strictness"
  artifacts:
    - path: "eslint.config.mjs"
      provides: "z-index rule at error severity"
      contains: '"error"'
  key_links:
    - from: "eslint.config.mjs"
      to: "all component .tsx files"
      via: "ESLint no-restricted-syntax rule"
      pattern: "no-restricted-syntax.*error"
---

<objective>
Upgrade ESLint z-index rule to error severity and delete legacy v7-index.ts barrel files.

Purpose: Prevent z-index regression by making hardcoded values a lint error. Remove orphaned v7-index.ts files that are no longer imported anywhere (verified in Phase 11).

Output: ESLint enforces z-index tokens at error level, 10 legacy barrel files deleted, full build passes.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-legacy-removal-stricter-rules/13-RESEARCH.md
@.planning/phases/13-legacy-removal-stricter-rules/13-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix z-index violations and upgrade ESLint rule</name>
  <files>
    - src/components/ui-v8/Modal.tsx
    - src/components/homepage/FloatingFood.tsx
    - src/components/homepage/Hero.tsx
    - eslint.config.mjs
  </files>
  <action>
**Step 1: Fix real violation in Modal.tsx**
Line 354: Change `z-10` to `z-dropdown`:
```tsx
// Before:
className={cn("absolute z-10", ...)}
// After:
className={cn("absolute z-dropdown", ...)}
```

**Step 2: Add ESLint disable for FloatingFood.tsx false positives**
The `FLOATING_FOOD_ITEMS` array (lines 56-125) uses `zIndex: 1|2|3` for local stacking within the component. Add block disable:

```tsx
/* eslint-disable no-restricted-syntax */
const FLOATING_FOOD_ITEMS: FloatingFoodItem[] = [
  // ... array content
];
/* eslint-enable no-restricted-syntax */
```

**Step 3: Add ESLint disable for Hero.tsx false positives**
Hero.tsx uses `isolate` class creating a local stacking context. Add inline disables:

Line 212 (canvas zIndex: 1):
```tsx
// eslint-disable-next-line no-restricted-syntax
style={{ width: "100%", height: "100%", zIndex: 1 }}
```

Line 219 (grain canvas zIndex: 2):
```tsx
// eslint-disable-next-line no-restricted-syntax
style={{ width: "100%", height: "100%", zIndex: 2 }}
```

Line 270 (motion.div zIndex: 3):
```tsx
// eslint-disable-next-line no-restricted-syntax
style={shouldAnimate ? { y: smoothContentY, opacity: smoothOpacity, zIndex: 3 } : { zIndex: 3 }}
```

Line 448 (bottom gradient zIndex: 4):
```tsx
{/* eslint-disable-next-line no-restricted-syntax */}
<div className="..." style={{ zIndex: 4 }} />
```

**Step 4: Upgrade ESLint rule to error**
In `eslint.config.mjs` line 45, change:
```javascript
// Before:
"no-restricted-syntax": ["warn", ...
// After:
"no-restricted-syntax": ["error", ...
```

Run `pnpm lint` to verify zero z-index violations.
  </action>
  <verify>
`pnpm lint 2>&1 | grep -c "z-index"` returns 0
  </verify>
  <done>Modal.tsx uses z-dropdown, false positives have ESLint disables, ESLint rule is error severity, lint passes.</done>
</task>

<task type="auto">
  <name>Task 2: Delete v7-index.ts files and final verification</name>
  <files>
    - src/components/admin/v7-index.ts
    - src/components/cart/v7-index.ts
    - src/components/checkout/v7-index.ts
    - src/components/driver/v7-index.ts
    - src/components/homepage/v7-index.ts
    - src/components/layout/v7-index.ts
    - src/components/layouts/v7-index.ts
    - src/components/menu/v7-index.ts
    - src/components/tracking/v7-index.ts
    - src/components/ui/v7-index.ts
  </files>
  <action>
**Step 1: Verify zero imports before deletion**
```bash
grep -r "v7-index" --include="*.ts" --include="*.tsx" src/ | grep -v "v7-index.ts:"
```
Expected: No output (zero imports).

**Step 2: Delete all 10 v7-index.ts files**
```bash
rm src/components/admin/v7-index.ts
rm src/components/cart/v7-index.ts
rm src/components/checkout/v7-index.ts
rm src/components/driver/v7-index.ts
rm src/components/homepage/v7-index.ts
rm src/components/layout/v7-index.ts
rm src/components/layouts/v7-index.ts
rm src/components/menu/v7-index.ts
rm src/components/tracking/v7-index.ts
rm src/components/ui/v7-index.ts
```

**Step 3: Final verification**
Run full verification suite:
```bash
pnpm lint && pnpm typecheck && pnpm build
```
All must pass.
  </action>
  <verify>
```bash
find src/components -name "v7-index.ts" | wc -l
```
Returns 0.

```bash
pnpm lint && pnpm typecheck && pnpm build
```
All pass with exit code 0.
  </verify>
  <done>10 v7-index.ts files deleted, full build passes with ESLint error severity and TypeScript strict flags.</done>
</task>

</tasks>

<verification>
Run comprehensive verification:
```bash
# Verify no v7-index.ts files remain
find src/components -name "v7-index.ts" | wc -l  # Should be 0

# Verify no imports reference v7-index
grep -r "v7-index" --include="*.ts" --include="*.tsx" src/ | wc -l  # Should be 0

# Verify ESLint rule is error severity
grep -A1 "no-restricted-syntax" eslint.config.mjs | head -2  # Should show "error"

# Full build verification
pnpm lint && pnpm typecheck && pnpm build  # All must pass
```
</verification>

<success_criteria>
- [ ] All 10 v7-index.ts barrel files deleted
- [ ] No imports reference v7-index paths
- [ ] ESLint z-index rule set to error (build fails on hardcoded z-index)
- [ ] TypeScript strict flags enabled (from 13-05)
- [ ] Build passes with all new strictness
</success_criteria>

<output>
After completion, create `.planning/phases/13-legacy-removal-stricter-rules/13-06-SUMMARY.md`
</output>
