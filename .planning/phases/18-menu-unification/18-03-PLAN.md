---
phase: 18-menu-unification
plan: 03
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - src/components/menu/menu-grid.tsx
  - src/components/menu/menu-section.tsx
  - src/components/menu/search-results-grid.tsx
  - src/components/ui-v8/cart/CartItemV8.tsx
  - src/app/(customer)/menu/page.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Menu page grid uses UnifiedMenuItemCard with variant='menu'"
    - "Menu cards have 3D tilt effect on hover"
    - "Grid is responsive: 1 column mobile, 2 columns tablet, 3 columns desktop"
    - "Cards have staggered scroll-reveal animation"
    - "Cart items use simplified horizontal layout matching unified card style"
    - "Cart items do NOT have 3D tilt (per CONTEXT.md)"
  artifacts:
    - path: "src/components/menu/menu-grid.tsx"
      provides: "Updated menu grid using UnifiedMenuItemCard"
      contains: "UnifiedMenuItemCard"
    - path: "src/components/ui-v8/cart/CartItemV8.tsx"
      provides: "Updated cart item with unified styling"
      contains: "glass-menu-card"
  key_links:
    - from: "menu-grid.tsx"
      to: "UnifiedMenuItemCard"
      via: "import and render"
      pattern: "import.*UnifiedMenuItemCard"
    - from: "menu-section.tsx"
      to: "menu-grid.tsx"
      via: "renders grid component"
      pattern: "<MenuGrid"
---

<objective>
Integrate UnifiedMenuItemCard into menu page grid and update cart items to match unified styling (without 3D tilt).

Purpose: Complete menu unification by updating menu browsing page and cart to use consistent card design.
Output: Menu page uses unified cards with tilt, cart items have matching visual style without tilt.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-menu-unification/18-CONTEXT.md
@.planning/phases/18-menu-unification/18-RESEARCH.md

# Reference: Plan 01 creates UnifiedMenuItemCard
@src/components/menu/UnifiedMenuItemCard/index.ts

# Menu page components to update
@src/components/menu/menu-grid.tsx
@src/components/menu/menu-section.tsx
@src/components/menu/search-results-grid.tsx
@src/app/(customer)/menu/page.tsx

# Cart item to update styling
@src/components/ui-v8/cart/CartItemV8.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update menu page to use UnifiedMenuItemCard</name>
  <files>
    src/components/menu/menu-grid.tsx
    src/components/menu/menu-section.tsx
    src/components/menu/search-results-grid.tsx
  </files>
  <action>
    1. Update `menu-grid.tsx`:
       - Import UnifiedMenuItemCard from "../UnifiedMenuItemCard"
       - Replace existing card component with UnifiedMenuItemCard variant="menu"
       - Keep responsive grid: grid-cols-1 sm:grid-cols-2 lg:grid-cols-3
       - Add staggered scroll-reveal animation per card:
         - Wrap each card in motion.div
         - initial: { opacity: 0, y: 18 }
         - whileInView: { opacity: 1, y: 0 }
         - viewport: { once: true, margin: "-50px" }
         - transition: { delay: Math.min(index * 0.08, 0.64), duration: 0.55 }
       - Pass categorySlug to each card for emoji fallback
       - Props: items, onItemClick, categorySlug

    2. Update `menu-section.tsx`:
       - If it renders cards directly, update to use UnifiedMenuItemCard
       - Ensure MenuGrid is used for grid layout
       - Pass all required props through

    3. Update `search-results-grid.tsx`:
       - Replace card component with UnifiedMenuItemCard variant="menu"
       - Keep search highlight functionality if present
       - Same responsive grid as menu-grid

    4. Ensure item click handlers pass through correctly:
       - onSelect prop should trigger detail modal/sheet
       - onQuickAdd prop for direct cart add (if supported)
  </action>
  <verify>
    - `grep "UnifiedMenuItemCard" src/components/menu/menu-grid.tsx` shows import and usage
    - `grep "variant.*menu" src/components/menu/menu-grid.tsx` shows correct variant
    - `grep "whileInView" src/components/menu/menu-grid.tsx` shows scroll animation
    - `npm run typecheck` passes
  </verify>
  <done>
    - menu-grid.tsx uses UnifiedMenuItemCard with variant="menu"
    - Staggered scroll-reveal animation on cards
    - Search results use same unified card
    - Click handlers work correctly
  </done>
</task>

<task type="auto">
  <name>Task 2: Update CartItemV8 to match unified styling</name>
  <files>
    src/components/ui-v8/cart/CartItemV8.tsx
  </files>
  <action>
    1. Update CartItemV8 visual styling to match unified card:
       - Add glassmorphism background: glass-menu-card class or equivalent inline
       - Rounded corners: rounded-2xl (slightly less than full cards)
       - Keep horizontal layout (image left, content right)
       - Maintain existing swipe-to-delete functionality

    2. Typography alignment:
       - Item name: font-semibold, same as CardContent
       - Modifiers: text-secondary, smaller
       - Price: use PriceTicker component (already used)

    3. Image styling:
       - Square aspect ratio (already correct)
       - Rounded corners matching card style
       - Keep existing size (w-16/w-20 based on compact prop)

    4. Do NOT add:
       - 3D tilt effect (per CONTEXT.md - cart focuses on checkout)
       - Shine effect
       - Hover scale

    5. Keep all existing functionality:
       - Swipe to delete with SwipeDeleteIndicator
       - Quantity selector
       - Edit button
       - Haptic feedback
  </action>
  <verify>
    - `grep "glass\|backdrop-blur" src/components/ui-v8/cart/CartItemV8.tsx` shows glassmorphism
    - `grep "rounded-2xl\|rounded-xl" src/components/ui-v8/cart/CartItemV8.tsx` shows rounded corners
    - `grep "rotateX\|rotateY" src/components/ui-v8/cart/CartItemV8.tsx` returns empty (no tilt)
    - `npm run typecheck` passes
  </verify>
  <done>
    - CartItemV8 has glassmorphism background matching unified cards
    - Rounded corners consistent with card design
    - No 3D tilt effect (correctly scoped per CONTEXT.md)
    - All existing cart functionality preserved
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify menu page integration and final cleanup</name>
  <files>
    src/app/(customer)/menu/page.tsx
  </files>
  <action>
    1. Verify menu page correctly renders updated components:
       - Check MenuGrid or MenuSection is used
       - Verify UnifiedMenuItemCard props are passed correctly
       - Ensure ItemDetailSheetV8 or equivalent still works

    2. Test responsive behavior:
       - Mobile: 1 column grid
       - Tablet: 2 column grid
       - Desktop: 3 column grid

    3. Remove any unused imports from updated files:
       - Remove old MenuItemCard imports if no longer used
       - Remove MenuItemCardV8 imports if replaced
       - Keep files clean

    4. Add deprecation comments to old card components (do not delete yet):
       - src/components/menu/MenuItemCard.tsx: Add comment "// @deprecated Use UnifiedMenuItemCard instead"
       - src/components/menu/menu-item-card.tsx: Same deprecation comment
       - src/components/ui-v8/menu/MenuItemCardV8.tsx: Same deprecation comment
       - These will be removed in a future cleanup phase
  </action>
  <verify>
    - `npm run typecheck && npm run lint && npm run build` all pass
    - `grep "@deprecated" src/components/menu/MenuItemCard.tsx` shows deprecation comment
    - `grep "UnifiedMenuItemCard" src/app/\(customer\)/menu/page.tsx` or its child components
  </verify>
  <done>
    - Menu page renders correctly with unified cards
    - Responsive grid works at all breakpoints
    - Unused imports removed
    - Old card components marked deprecated
    - Full build succeeds
  </done>
</task>

</tasks>

<verification>
Run:
```bash
npm run typecheck && npm run lint && npm run build
```

Manual verification:
1. Visit /menu page
2. Cards display with glassmorphism and 3D tilt
3. Grid responds to viewport (1/2/3 columns)
4. Cards animate in on scroll
5. Click card opens detail
6. Add to cart and check cart drawer
7. Cart items have matching style without tilt
8. Swipe to delete still works in cart
</verification>

<success_criteria>
- [ ] Menu page uses UnifiedMenuItemCard with variant="menu"
- [ ] Cards have 3D tilt effect on menu page
- [ ] Responsive grid: 1/2/3 columns
- [ ] Staggered scroll-reveal animation working
- [ ] Cart items have glassmorphism styling
- [ ] Cart items do NOT have tilt effect
- [ ] All existing cart functionality works
- [ ] Old components marked deprecated
- [ ] TypeScript compiles without errors
- [ ] Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/18-menu-unification/18-03-SUMMARY.md`
</output>
