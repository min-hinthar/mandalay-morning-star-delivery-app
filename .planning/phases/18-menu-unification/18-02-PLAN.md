---
phase: 18-menu-unification
plan: 02
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - src/components/menu/FeaturedCarousel/index.ts
  - src/components/menu/FeaturedCarousel/FeaturedCarousel.tsx
  - src/components/menu/FeaturedCarousel/CarouselControls.tsx
  - src/components/homepage/HomepageMenuSection.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Homepage displays 10 featured items in horizontal carousel"
    - "Carousel auto-scrolls when user is not interacting"
    - "Carousel pauses auto-scroll on hover/touch"
    - "Arrow buttons on sides navigate carousel"
    - "Dots indicator below shows current position"
    - "Cards in carousel use UnifiedMenuItemCard with homepage variant"
    - "Cards have staggered entrance animation when scrolling into view"
  artifacts:
    - path: "src/components/menu/FeaturedCarousel/FeaturedCarousel.tsx"
      provides: "Auto-scrolling carousel for featured items"
      exports: ["FeaturedCarousel"]
    - path: "src/components/menu/FeaturedCarousel/CarouselControls.tsx"
      provides: "Arrow buttons and dots indicator"
      exports: ["CarouselControls"]
    - path: "src/components/homepage/HomepageMenuSection.tsx"
      provides: "Updated homepage menu with featured carousel"
      contains: "FeaturedCarousel"
  key_links:
    - from: "FeaturedCarousel.tsx"
      to: "UnifiedMenuItemCard"
      via: "import and render"
      pattern: "import.*UnifiedMenuItemCard"
    - from: "HomepageMenuSection.tsx"
      to: "FeaturedCarousel"
      via: "render featured section"
      pattern: "<FeaturedCarousel"
---

<objective>
Create FeaturedCarousel component for homepage featuring 10 popular items with auto-scroll, navigation controls, and integrate with homepage menu section.

Purpose: Replace grid layout on homepage with engaging carousel showcasing featured items, encouraging menu exploration.
Output: Working featured carousel on homepage with auto-scroll and navigation.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-menu-unification/18-CONTEXT.md
@.planning/phases/18-menu-unification/18-RESEARCH.md

# Reference: Plan 01 creates UnifiedMenuItemCard
@src/components/menu/UnifiedMenuItemCard/index.ts

# Existing carousel pattern
@src/components/menu/CategoryCarousel.tsx

# Current homepage implementation to update
@src/components/homepage/HomepageMenuSection.tsx

# Motion tokens
@src/lib/motion-tokens.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CarouselControls and FeaturedCarousel components</name>
  <files>
    src/components/menu/FeaturedCarousel/index.ts
    src/components/menu/FeaturedCarousel/CarouselControls.tsx
    src/components/menu/FeaturedCarousel/FeaturedCarousel.tsx
  </files>
  <action>
    1. Create `src/components/menu/FeaturedCarousel/` directory

    2. Create `CarouselControls.tsx`:
       - Props: totalItems, currentIndex, onPrev, onNext, onDotClick
       - Left/Right arrow buttons:
         - Position absolute on sides of carousel
         - ChevronLeft/ChevronRight icons from lucide-react
         - Circular buttons with glass background
         - Hide left when at start, right when at end
         - whileHover scale 1.1, whileTap scale 0.9
       - Dots indicator:
         - Render below carousel
         - Active dot larger/filled, inactive smaller/outline
         - Click on dot jumps to that position
         - Use framer-motion layoutId for smooth active indicator

    3. Create `FeaturedCarousel.tsx`:
       - Props: items (MenuItem[]), autoScrollInterval (default 4000ms)
       - Use native scroll container with scroll-snap-type: x mandatory
       - Each card wrapper has scroll-snap-align: start
       - Auto-scroll logic:
         - useInterval hook to scrollBy every autoScrollInterval
         - useState isPaused, set true on mouseenter/touchstart/dragstart
         - Resume on mouseleave with 2s delay
         - If user manually scrolls, cancel auto-scroll permanently (useState userHasScrolled)
       - Track current index via IntersectionObserver on cards
       - Render UnifiedMenuItemCard with variant="homepage"
       - Render CarouselControls below
       - Cards have staggered whileInView animation:
         - initial: { opacity: 0, y: 18 }
         - whileInView: { opacity: 1, y: 0 }
         - viewport: { once: true, margin: "-50px" }
         - delay: Math.min(index * 0.08, 0.64)
       - Gap between cards: gap-4 on mobile, gap-6 on desktop
       - Card width: w-[280px] on mobile, w-[320px] on desktop

    4. Create `index.ts`:
       - Export FeaturedCarousel, CarouselControls
  </action>
  <verify>
    - `ls src/components/menu/FeaturedCarousel/` shows all 3 files
    - `grep "scroll-snap" src/components/menu/FeaturedCarousel/FeaturedCarousel.tsx` shows snap behavior
    - `grep "autoScrollInterval\|isPaused" src/components/menu/FeaturedCarousel/FeaturedCarousel.tsx` shows auto-scroll
    - `grep "ChevronLeft\|ChevronRight" src/components/menu/FeaturedCarousel/CarouselControls.tsx` shows arrows
  </verify>
  <done>
    - FeaturedCarousel renders items with scroll-snap and auto-scroll
    - CarouselControls has arrow buttons and dots
    - Auto-scroll pauses on interaction, resumes on leave
    - Cards animate in with stagger when scrolling into view
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate FeaturedCarousel into HomepageMenuSection</name>
  <files>
    src/components/homepage/HomepageMenuSection.tsx
  </files>
  <action>
    1. Import FeaturedCarousel and UnifiedMenuItemCard

    2. Add featured items section BEFORE the category grid:
       - Filter items with tag "featured" or "popular" (limit to 10)
       - If < 5 featured items, pad with random items to reach 10
       - Render FeaturedCarousel with featured items
       - Section title: "Featured Dishes" with Star icon badge

    3. Keep existing category grid below for "Browse All" section:
       - Replace MenuItemCardV8 with UnifiedMenuItemCard variant="menu"
       - Keep existing search, category tabs, and grid layout
       - Update stagger animation to use UnifiedMenuItemCard

    4. Ensure smooth scroll between featured and browse sections

    5. Handle item click:
       - Featured carousel items open ItemDetailSheetV8 (same as current)
       - Pass onSelect handler to FeaturedCarousel
  </action>
  <verify>
    - `npm run typecheck` passes
    - `grep "FeaturedCarousel" src/components/homepage/HomepageMenuSection.tsx` shows import and usage
    - `grep "UnifiedMenuItemCard" src/components/homepage/HomepageMenuSection.tsx` shows card usage
    - `grep "featured\|popular" src/components/homepage/HomepageMenuSection.tsx` shows filtering
  </verify>
  <done>
    - Homepage shows FeaturedCarousel with 10 items at top
    - Browse section uses UnifiedMenuItemCard
    - Item clicks open detail sheet
    - Featured filtering works correctly
  </done>
</task>

</tasks>

<verification>
Run:
```bash
npm run typecheck && npm run lint && npm run build
```

Manual verification:
1. Visit homepage
2. Featured carousel visible with 10 items
3. Auto-scroll works (wait 4 seconds)
4. Hover pauses auto-scroll
5. Arrow buttons navigate
6. Dots indicator updates
7. Click card opens detail sheet
8. Browse section still works with grid
</verification>

<success_criteria>
- [ ] FeaturedCarousel component created and exported
- [ ] CarouselControls with arrows and dots working
- [ ] Homepage shows featured carousel section
- [ ] Auto-scroll works with pause on interaction
- [ ] Browse section uses UnifiedMenuItemCard
- [ ] Item selection opens detail sheet
- [ ] TypeScript compiles without errors
- [ ] Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/18-menu-unification/18-02-SUMMARY.md`
</output>
