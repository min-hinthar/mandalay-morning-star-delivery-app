# Milestone v1.1: Tech Debt Cleanup

**Status:** SHIPPED 2026-01-23
**Phases:** 9-14
**Total Plans:** 21

## Overview

Eliminate all legacy code patterns and migrate admin/driver flows to V8 components.

**Definition of Done (all achieved):**
- Zero z-index ESLint violations (64 → 0)
- No V7 component imports anywhere in codebase
- All colors/spacing using token system
- Dead exports removed (44 files deleted)
- Admin flow migrated to V8 components
- Driver flow migrated to V8 components

## Phases

### Phase 9: Analysis & Component Creation

**Goal**: Establish baseline state and create missing V8 components
**Depends on**: Phase 8 (v1.0 complete)
**Requirements**: QUAL-01, COMP-01, TEST-01
**Plans**: 2 plans

Plans:
- [x] 09-01-PLAN.md — Dead code analysis with knip and TimeStepV8 component creation
- [x] 09-02-PLAN.md — Visual regression baseline snapshot generation for 11 pages

**Deliverables:**
- Dead code report: 47 unused files, 480 exports, 284 types
- TimeStepV8 component: 109 lines, V8 patterns
- Visual regression tests: 36 tests ready (baselines deferred to network-enabled environment)

### Phase 10: Token Migration

**Goal**: All hardcoded z-index and color values use design tokens
**Depends on**: Phase 9
**Requirements**: ZIDX-01, ZIDX-02, ZIDX-03, ZIDX-04, ZIDX-05, COLR-01, COLR-02, COLR-03, COLR-04
**Plans**: 4 plans

Plans:
- [x] 10-01-PLAN.md — Homepage z-index token migration (7 files)
- [x] 10-02-PLAN.md — Menu z-index token migration (10 files)
- [x] 10-03-PLAN.md — Tracking and UI z-index token migration (9 files)
- [x] 10-04-PLAN.md — Remaining z-index and color token migration (10 files)

**Deliverables:**
- 36 files migrated to z-index tokens
- Zero ESLint z-index warnings codebase-wide
- Color tokens applied to header, FlipCard, charts

### Phase 11: V8 Component Migration

**Goal**: Admin, driver, hero, and tracking use V8 component patterns
**Depends on**: Phase 10
**Requirements**: V7MG-01, V7MG-02, V7MG-03, V7MG-04, COMP-02
**Plans**: 4 plans

Plans:
- [x] 11-01-PLAN.md — Admin dashboard V8 migration (1 file)
- [x] 11-02-PLAN.md — Driver dashboard V8 migration (1 file)
- [x] 11-03-PLAN.md — Homepage, tracking, and layout V8 migration (5 files)
- [x] 11-04-PLAN.md — TimeStep verification and final sweep

**Deliverables:**
- All active code paths use direct V8 imports (7 files migrated)
- Zero v7-index imports remaining

### Phase 12: Dead Code & Export Cleanup

**Goal**: No dead code remains in exports
**Depends on**: Phase 11
**Requirements**: QUAL-02, EXPT-01, EXPT-02, EXPT-03, EXPT-04
**Plans**: 3 plans

Plans:
- [x] 12-01-PLAN.md — Delete unused utility/infrastructure files (16 files deleted)
- [x] 12-02-PLAN.md — Clean UI and checkout barrel exports (removed Legacy* aliases)
- [x] 12-03-PLAN.md — Delete unused component files (6 deleted, 2 restored as actively used)

**Deliverables:**
- 22 dead files deleted
- Barrel exports cleaned (ui/index.ts, checkout/index.ts)
- Confetti and DropdownAction verified as actively used

### Phase 13: Legacy Removal & Stricter Rules

**Goal**: Prevent regression with enforced rules and removed legacy files
**Depends on**: Phase 12
**Requirements**: V7MG-05, ZIDX-06, QUAL-03
**Plans**: 6 plans

Plans:
- [x] 13-01-PLAN.md — Fix TypeScript violations in API routes and E2E test (15 files)
- [x] 13-02-PLAN.md — Fix TypeScript violations in admin, auth, checkout, driver components (11 files)
- [x] 13-03-PLAN.md — Fix TypeScript violations in homepage, layouts, mascot, menu, theme components (10 files)
- [x] 13-04-PLAN.md — Fix TypeScript violations in tracking, ui-v8, ui, lib files (15 files)
- [x] 13-05-PLAN.md — Enable TypeScript strict flags (tsconfig.json)
- [x] 13-06-PLAN.md — ESLint z-index upgrade to error and v7-index.ts deletion (14 files)

**Deliverables:**
- 10 v7-index.ts barrel files deleted (366 lines removed)
- TypeScript strict flags enabled (noUnusedLocals, noUnusedParameters)
- ESLint z-index rule upgraded to error severity

### Phase 14: Testing & Documentation

**Goal**: Complete visual regression coverage and accurate documentation
**Depends on**: Phase 13
**Requirements**: TEST-02, TEST-03, DOCS-01, DOCS-02
**Plans**: 2 plans

Plans:
- [x] 14-01-PLAN.md — Admin and driver visual regression tests (TEST-02, TEST-03)
- [x] 14-02-PLAN.md — Z-INDEX-MIGRATION.md completion update and v7-index verification (DOCS-01, DOCS-02)

**Deliverables:**
- 78 visual regression tests (39 per browser)
- mockFonts helper for network independence
- Z-INDEX-MIGRATION.md updated to completion status

## Progress

| Phase | Plans | Status | Completed |
|-------|-------|--------|-----------|
| 9. Analysis & Component Creation | 2/2 | Complete | 2026-01-23 |
| 10. Token Migration | 4/4 | Complete | 2026-01-23 |
| 11. V8 Component Migration | 4/4 | Complete | 2026-01-23 |
| 12. Dead Code & Export Cleanup | 3/3 | Complete | 2026-01-23 |
| 13. Legacy Removal & Stricter Rules | 6/6 | Complete | 2026-01-23 |
| 14. Testing & Documentation | 2/2 | Complete | 2026-01-23 |

---

## Milestone Summary

**Key Decisions:**
- knip for dead code analysis (ESM-native, Next.js compatible)
- TimeStepV8 uses enhanced TimeSlotPicker (consistent V8 patterns)
- Semantic z-index tokens (z-dropdown, z-sticky, z-fixed)
- ESLint z-index at error severity (prevents regression)
- Local stacking contexts exempt from token rule
- mockFonts helper for network-independent visual tests

**Issues Resolved:**
- 64 z-index violations eliminated
- All v7-index.ts legacy barrels removed
- Dead code identified and removed (44 files)

**Issues Deferred:**
- Visual regression baseline generation (requires network-enabled environment)

**Technical Debt Incurred:**
- None new; resolved all tech debt from v1.0

---

*For current project status, see .planning/PROJECT.md*
*Archived: 2026-01-23*
